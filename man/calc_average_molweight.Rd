% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/functions-chem.R
\name{calc_average_molweight}
\alias{calc_average_molweight}
\title{Calculate Average Molecular Weight from Chemical Formulas}
\usage{
calc_average_molweight(formula)
}
\arguments{
\item{formula}{A character vector of one or more chemical formulas to process.}
}
\value{
A numeric vector of average molecular weights, one for each formula.
}
\description{
Calculates the average molecular weight of one or more chemical formulas, based on the natural isotopic distribution of elements.
The calculation uses the \pkg{enviPat} package to retrieve isotopic masses and abundances, and computes the weighted mean of the isotopic distribution.
}
\details{
This function calculates the \emph{average molecular weight} (not monoisotopic mass), which reflects the average of the isotopic distribution found in nature.

Isotopes can be specified explicitly in the formula. Atomic mass numbers for isotopes must be enclosed in square brackets (e.g., \verb{[13]C} for carbon-13).
Deuterium must be written as \code{D} instead of \verb{[3]H}.

The function uses the \pkg{enviPat} package to validate and parse chemical formulas, calculate isotopic patterns,
and determine the average molecular weight based on weighted means of isotopic abundances.
}
\examples{
calc_average_molweight(c("C6H12O6", "[13]C6H12O6", "C8H10N4O2", "D2O"))

}
\references{
Loos, M., Gerber, C., Corona, F., Hollender, J., & Singer, H. (2015).
Accelerated Isotope Fine Structure Calculation Using Pruned Transition Trees.
\emph{Analytical Chemistry}, 87(11), 5738â€“5744. \doi{10.1021/acs.analchem.5b00941}
}
