% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plots-qc-runorder.R
\name{qc_plot_runscatter}
\alias{qc_plot_runscatter}
\title{Create a Run Scatter Plot to Visualize Analyte Distributions}
\usage{
qc_plot_runscatter(
  data = NULL,
  variable = c("intensity", "norm_intensity", "conc", "conc_raw", "area", "height",
    "fwhm"),
  filter_data = FALSE,
  qc_types = NA,
  include_qualifier = TRUE,
  include_feature_filter = NA,
  exclude_feature_filter = NA,
  plot_range_indices = NA,
  output_pdf = FALSE,
  path = "",
  log_scale = FALSE,
  cap_outliers = FALSE,
  cap_qc_k_mad = 4,
  cap_spl_k_mad = 4,
  cap_top_n_values = NA,
  show_batches = TRUE,
  show_control_limits = NA,
  set_limits_n_sd = NA,
  limits_batchwise = FALSE,
  limits_linecolor = "#38dff5",
  limits_linewidth = 0.75,
  batches_as_shades = FALSE,
  batch_line_color = "#b6f0c5",
  batch_shading_color = "grey93",
  cols_page = 3,
  rows_page = 3,
  base_font_size = 11,
  annot_scale = 1,
  show_trend = FALSE,
  trend_linecolor = "#22e06b",
  fit_qc_type = "BQC",
  page_orientation = "LANDSCAPE",
  point_transparency = 1,
  point_size = 2,
  point_border_width = 1,
  specific_page = NA,
  y_label_text = NA,
  return_plots = FALSE,
  show_gridlines = FALSE,
  show_progress = FALSE
)
}
\arguments{
\item{data}{MidarExperiment object}

\item{variable}{Variable to plot, one of 'area', 'height', 'intensity', 'norm_intensity', 'intensity_raw', 'norm_intensity_raw', 'response', 'conc', 'conc_raw', 'rt', 'fwhm.'}

\item{filter_data}{Logical, whether to use QC-filtered data based on criteria set via \code{qc_apply_feature_filter()}}

\item{qc_types}{QC types to be shown. Can be a vector of QC types or a regular expression pattern. \code{NA} (default) displays all available QC/Sample types.}

\item{include_qualifier}{Logical, whether to include qualifier features}

\item{include_feature_filter}{Regex pattern to select features by feature_id. \code{NA} or \code{""} ignores the filter.}

\item{exclude_feature_filter}{Regex pattern to exclude features by feature_id. \code{NA} or \code{""} ignores the filter.}

\item{plot_range_indices}{Numeric vector of length 2, specifying the start and end indices of the sequence to be plotted. \code{NA} plots all samples.}

\item{output_pdf}{Logical, whether to save the plot as a PDF file}

\item{path}{File name for the PDF output}

\item{log_scale}{Logical, whether to use a log10 scale for the y-axis}

\item{cap_outliers}{Logical, whether to cap upper outliers based on MAD fences of SPL and QC samples}

\item{cap_qc_k_mad}{Numeric, k * MAD (median absolute deviation) for outlier capping of QC samples}

\item{cap_spl_k_mad}{Numeric, k * MAD (median absolute deviation) for outlier capping of SPL samples}

\item{cap_top_n_values}{Numeric, cap the top n values regardless of MAD fences. \code{NA} or \code{0} ignores this filter.}

\item{show_batches}{Logical, whether to show batch separators in the plot}

\item{show_control_limits}{Logical, whether to show the mean line for the specified QC types. \code{NA} ignores the mean line.}

\item{set_limits_n_sd}{Numeric, show +/- n x SD lines for the QC types defined in \code{show_control_limits}. \code{NA} ignores the SD lines.}

\item{limits_batchwise}{Logical, whether to calculate the mean and SD lines per batch}

\item{limits_linecolor}{Color of the mean and SD lines}

\item{limits_linewidth}{Width of the mean and SD lines}

\item{batches_as_shades}{Logical, whether to show batches as shaded areas instead of line separators}

\item{batch_line_color}{Color of the batch separator lines}

\item{batch_shading_color}{Color of the batch shaded areas}

\item{cols_page}{Number of columns per page}

\item{rows_page}{Number of rows per page}

\item{base_font_size}{Base font size for the plot}

\item{annot_scale}{Scale factor for text elements}

\item{show_trend}{Logical, whether to show a drift correction trend line}

\item{trend_linecolor}{Color of the trend line}

\item{fit_qc_type}{QC type used for smoothing the trend line}

\item{page_orientation}{Page orientation, "LANDSCAPE" or "PORTRAIT"}

\item{point_transparency}{Alpha transparency of the data points}

\item{point_size}{Size of the data points}

\item{point_border_width}{Width of the data point borders}

\item{specific_page}{Integer, show/save a specific page number. \code{NA} plots/saves all pages.}

\item{y_label_text}{Override the default y-axis label text}

\item{return_plots}{Logical, whether to return the list of ggplot objects}

\item{show_gridlines}{Logical, whether to show major x and y gridlines}

\item{show_progress}{Logical, whether to show a progress bar}
}
\value{
A list of ggplot2 plots, or \code{NULL} if \code{return_plots = FALSE}
}
\description{
The run scatter plot allows you to visualize the sequence of measurements and distribution of QC (sample) types across the analysis run sequence.
This can be useful for identifying trends, outliers, or other patterns in the data.

The function provides a range of options for customizing the plot, such as:
\itemize{
\item Filtering the data (e.g., by QC type, feature ID)
\item Applying outlier capping
\item Displaying batch information and control limits
\item Showing trend lines for drift correction
\item Controlling the layout and appearance of the plot
}
}
