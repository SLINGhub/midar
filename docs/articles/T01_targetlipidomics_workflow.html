<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Lipidomics Data Processing • midar</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Lipidomics Data Processing">
<meta name="description" content="MiDAR: Postprocessing and Quality Control of Small-Molecule Mass Spectrometry Data
">
<meta property="og:description" content="MiDAR: Postprocessing and Quality Control of Small-Molecule Mass Spectrometry Data
">
<meta property="og:image" content="https://slinghub.github.io/midar/logo.svg">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">midar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.5.9003</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/00_get_started.html">Get started</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials-recipes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials/Recipes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials-recipes">
<li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/T01_prepdata.html">Preparing and importing data</a></li>
    <li><a class="dropdown-item" href="../articles/T02_settingup_workflow.html">Setting Up a Basic MiDAR Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/T01_targetlipidomics_workflow.html">Targeted lipidomics with QC</a></li>
    <li><a class="dropdown-item" href="../articles/T_BatchDriftCorrect.html">Drift and Batch Correction</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Recipes</h6></li>
    <li><a class="dropdown-item" href="../articles/R01_quantms.html">Quantitative assay with ext. calibration and QC</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-manual" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Manual</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-manual">
<li><h6 class="dropdown-header" data-toc-skip>Key Concepts</h6></li>
    <li><a class="dropdown-item" href="../articles/01_datastructure.html">Data Structures</a></li>
    <li><a class="dropdown-item" href="../articles/02_keydataids.html">Data Indentifier</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Data and Metadata</h6></li>
    <li><a class="dropdown-item" href="../articles/03_midarexperiment.html">MidarExperiment Object</a></li>
    <li><a class="dropdown-item" href="../articles/04_dataimport.html">Data Import</a></li>
    <li><a class="dropdown-item" href="../articles/05_metadataimport.html">Metadata Import</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/07_driftbatchcorr.html">Batch/Drift Correction</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SLINGhub/midar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Lipidomics Data Processing</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/SLINGhub/midar/blob/HEAD/vignettes/articles/T01_targetlipidomics_workflow.Rmd" class="external-link"><code>vignettes/articles/T01_targetlipidomics_workflow.Rmd</code></a></small>
      <div class="d-none name"><code>T01_targetlipidomics_workflow.Rmd</code></div>
    </div>

    
    
<p>This tutorial illustrates a postprocessing and quality control
workflow starting from a preprocessing data from an lipidomics analysis.
Starting from peak areas, the iam is to produce a curated dataset with
lipid species concentrations that is ready for subsequent statistical
analysss. This post-processing will include an assessment of the
analytical and data quality of the lipidomics analysis, followed by
normalisation/quantification, feature filtering and reporting of the
dataset.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/SLINGhub/midar" class="external-link">midar</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="importing-analysis-results">1. Importing analysis results<a class="anchor" aria-label="anchor" href="#importing-analysis-results"></a>
</h2>
<p>We begin by importing the MRMkit result file, which contains the
areas of the integrated peaks (features) in all the processed raw data
files. In addition, the MRMkit result file also contains peak retention
times and widths, as well as metadata extracted from the mzML files,
such as acquisition time stamp and m/z values. We import these metadata
by setting <code>import_metadata = TRUE</code>.</p>
<details><summary>
Exercises
</summary><blockquote>
<p>Type <code>print(myexp)</code> in the console to get a summary of the
status. You can explore the <code>myexp</code> object in RStudio by
clicking it in the Environment panel on the top right.</p>
</blockquote>
</details><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myexp</span> <span class="op">&lt;-</span> <span class="fu">midar</span><span class="fu">::</span><span class="fu"><a href="../reference/MidarExperiment.html">MidarExperiment</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"sPerfect"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_path</span> <span class="op">&lt;-</span> <span class="st">"datasets/sPerfect_MRMkit.tsv"</span></span>
<span><span class="va">myexp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/import_data_mrmkit.html">import_data_mrmkit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">myexp</span>, path <span class="op">=</span> <span class="va">data_path</span>, import_metadata <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #00BB00;">Imported 499 analyses with 503 features</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="color: #555555;">`feature_area` selected as default feature intensity. Modify with `set_intensity_var()`.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #00BB00;">Analysis metadata associated with 499 analyses.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #00BB00;">Feature metadata associated with 503 features.</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="a-glimpse-on-the-imported-data">2. A glimpse on the imported data<a class="anchor" aria-label="anchor" href="#a-glimpse-on-the-imported-data"></a>
</h2>
<p>Let us examine the imported data by executing the code below or by
entering the command <code>View(myexp@dataset_orig)</code> in the
console. As can be observed, the data is in long format, thereby
enabling the user to view multiple parameters for each analysis-feature
pair.</p>
<details><summary>
Exercises
</summary><blockquote>
<p>Explore the imported table using in the RStudio table viewer with the
filter functionality.</p>
</blockquote>
</details><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">myexp</span><span class="op">@</span><span class="va">dataset</span><span class="op">)</span> <span class="co"># Better use `get_rawdata(mexp, "original")`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 250,997 × 19</span></span></span>
<span><span class="co">#&gt;    analysis_order analysis_id  acquisition_time_stamp qc_type batch_id sample_id</span></span>
<span><span class="co">#&gt;             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>              1 Longit_BLAN… 2017-10-20 <span style="color: #949494;">14:15:36</span>    SBLK    1        <span style="color: #BB0000;">NA</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>              1 Longit_BLAN… 2017-10-20 <span style="color: #949494;">14:15:36</span>    SBLK    1        <span style="color: #BB0000;">NA</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>              1 Longit_BLAN… 2017-10-20 <span style="color: #949494;">14:15:36</span>    SBLK    1        <span style="color: #BB0000;">NA</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>              1 Longit_BLAN… 2017-10-20 <span style="color: #949494;">14:15:36</span>    SBLK    1        <span style="color: #BB0000;">NA</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>              1 Longit_BLAN… 2017-10-20 <span style="color: #949494;">14:15:36</span>    SBLK    1        <span style="color: #BB0000;">NA</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>              1 Longit_BLAN… 2017-10-20 <span style="color: #949494;">14:15:36</span>    SBLK    1        <span style="color: #BB0000;">NA</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>              1 Longit_BLAN… 2017-10-20 <span style="color: #949494;">14:15:36</span>    SBLK    1        <span style="color: #BB0000;">NA</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>              1 Longit_BLAN… 2017-10-20 <span style="color: #949494;">14:15:36</span>    SBLK    1        <span style="color: #BB0000;">NA</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>              1 Longit_BLAN… 2017-10-20 <span style="color: #949494;">14:15:36</span>    SBLK    1        <span style="color: #BB0000;">NA</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>              1 Longit_BLAN… 2017-10-20 <span style="color: #949494;">14:15:36</span>    SBLK    1        <span style="color: #BB0000;">NA</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 250,987 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 13 more variables: replicate_no &lt;int&gt;, specimen &lt;chr&gt;, feature_id &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   feature_class &lt;chr&gt;, feature_label &lt;chr&gt;, is_istd &lt;lgl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   is_quantifier &lt;lgl&gt;, analyte_id &lt;chr&gt;, feature_rt &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   feature_area &lt;dbl&gt;, feature_height &lt;dbl&gt;, feature_fwhm &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   feature_intensity &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="analytical-design-and-timeline">3. Analytical design and timeline<a class="anchor" aria-label="anchor" href="#analytical-design-and-timeline"></a>
</h2>
<p>An overview of the analysis design and timelines can provide useful
information for subsequent processing steps. The plot below illustrates
the batch structure, the quality control (QC) samples included with
their respective positions, and additional information regarding the
date, duration, and run time of the analysis.</p>
<details><summary>
Exercises
</summary><blockquote>
<p>Show analysis timestamps with <code>show_timestamp = TRUE</code>.
Have there been long interruptions within and between the batches?</p>
</blockquote>
</details><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_runsequence.html">plot_runsequence</a></span><span class="op">(</span></span>
<span>  <span class="va">myexp</span>, </span>
<span>  qc_types <span class="op">=</span> <span class="cn">NA</span>, </span>
<span>  show_batches <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>  batch_zebra_stripe <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>  batch_fill_color <span class="op">=</span> <span class="st">"#fffbdb"</span>, </span>
<span>  segment_linewidth <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  show_timestamp <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="T01_targetlipidomics_workflow_files/figure-html/runsequence-1.png" alt="RunSequence plot" width="100%"></p>
</div>
<div class="section level2">
<h2 id="signal-trends-of-internal-standards">4. Signal trends of Internal Standards<a class="anchor" aria-label="anchor" href="#signal-trends-of-internal-standards"></a>
</h2>
<p>We can look at the internal standards (ISTDs) in all samples across
all six batches to see how the analyses went. The same ISTD amount was
spiked into each sample (except <code>SBLK</code>) so we should expect
the same intensities in all samples and sample types.</p>
<details><summary>
Exercises
</summary><blockquote>
<p>What do you observe? You can set <code>output_pdf = TRUE</code> to
save the plots as PDF (see subfolder <code>output</code>).</p>
</blockquote>
</details><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_runscatter.html">plot_runscatter</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">myexp</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"intensity"</span>,</span>
<span>  qc_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BQC"</span>, <span class="st">"TQC"</span>, <span class="st">"SPL"</span>, <span class="st">"PBLK"</span>, <span class="st">"SBLK"</span><span class="op">)</span>,</span>
<span>  analysis_order_range <span class="op">=</span> <span class="cn">NA</span>, <span class="co">#get_batch_boundaries(myexp, c(1,6)), </span></span>
<span>  include_feature_filter <span class="op">=</span> <span class="st">"ISTD"</span>, </span>
<span>  exclude_feature_filter <span class="op">=</span> <span class="st">"Hex|282"</span>,</span>
<span>  cap_outliers <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  log_scale <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>  show_batches <span class="op">=</span> <span class="cn">TRUE</span>,base_font_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  output_pdf <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  path <span class="op">=</span> <span class="st">"./output/runscatter_istd.pdf"</span>,</span>
<span>  cols_page <span class="op">=</span> <span class="fl">4</span>, rows_page <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Generating plots (3 pages)...</span></span></span></code></pre></div>
<p><img src="T01_targetlipidomics_workflow_files/figure-html/runscatter-1.png" alt="RunScatter plot" width="100%"><img src="T01_targetlipidomics_workflow_files/figure-html/runscatter-2.png" alt="RunScatter plot" width="100%"><img src="T01_targetlipidomics_workflow_files/figure-html/runscatter-3.png" alt="RunScatter plot" width="100%"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;"> - done!</span></span></span></code></pre>
</div>
<div class="section level2">
<h2 id="adding-detailed-metadata">5. Adding detailed metadata<a class="anchor" aria-label="anchor" href="#adding-detailed-metadata"></a>
</h2>
<p>To proceed with further processing, we require additional metadata
describing the samples and features. The
<code>MiDAR Excel template</code> provides a solution for the
collection, organisation and pre-validation of analysis metadata. Import
metadata from this template using the function below. If there are
errors in the metadata (e.g. duplicate or missing ID), the import will
fail with an error message and summary of the errors. If the metadata is
error-free, a summary of warnings and notes about the metadata will be
shown in a table, if present. Check your metadata by working through
these warnings, or proceed using
<code>ignore_warnings = TRUE</code>.</p>
<details><summary>
Exercises
</summary><blockquote>
<p>Open the <code>XLSM</code> file in the <code>data</code> folder to
explore the metadata structure (click ‘Disable Macros’).</p>
</blockquote>
</details><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">file_path</span> <span class="op">&lt;-</span> <span class="st">"datasets/sPerfect_Metadata.xlsm"</span></span>
<span><span class="va">myexp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/import_metadata_msorganizer.html">import_metadata_msorganizer</a></span><span class="op">(</span><span class="va">myexp</span>, path <span class="op">=</span> <span class="va">file_path</span>, ignore_warnings <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> <span style="color: #BBBB00;">Metadata has following warnings and notifications:</span></span></span>
<span><span class="co">#&gt; <span style="color: #000000;">--------------------------------------------------------------------------------------------</span></span></span>
<span><span class="co">#&gt;   Type Table    Column                Issue                           Count</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> W*   Analyses analysis_id           Analyses not in analysis data      15</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> W*   Features feature_id            Feature(s) not in analysis data     4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> W*   Features feature_id            Feature(s) without metadata         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> W*   ISTDs    quant_istd_feature_id Internal standard(s) not used       1</span></span>
<span><span class="co">#&gt; <span style="font-style: italic;">--------------------------------------------------------------------------------------------</span></span></span>
<span><span class="co"><span style="font-style: italic;">#&gt; E = Error, W = Warning, W* = Supressed Warning, N = Note</span></span></span>
<span><span class="co"><span style="font-style: italic;">#&gt; --------------------------------------------------------------------------------------------</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #00BB00;">Analysis metadata associated with 499 analyses.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #00BB00;">Feature metadata associated with 502 features.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #00BB00;">Internal Standard metadata associated with 17 ISTDs.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #00BB00;">Response curve metadata associated with 12 annotated analyses.</span></span></span>
<span><span class="va">myexp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_analysis_order.html">set_analysis_order</a></span><span class="op">(</span><span class="va">myexp</span>, order_by <span class="op">=</span> <span class="st">"timestamp"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #00BB00;">Analysis order set to </span><span style="color: #0000BB;">"timestamp"</span></span></span>
<span><span class="va">myexp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_intensity_var.html">set_intensity_var</a></span><span class="op">(</span><span class="va">myexp</span>, variable_name <span class="op">=</span> <span class="st">"area"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #00BB00;">Default feature intensity variable set to </span><span style="color: #0000BB;">"feature_area"</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="overall-trends-and-possible-outlier">6. Overall trends and possible outlier<a class="anchor" aria-label="anchor" href="#overall-trends-and-possible-outlier"></a>
</h2>
<p>To examine overall technical trends and issues affecting the majority
of analytes (features), the RLA (Relative Log Abundance) plot is a
useful tool (De Livera et al., Analytical Chemistry, 2015). In this
plot, all features are normalised (by across or within-batch medians)
and plotted as a boxplot per sample. This plot can help to identify
potential pipetting errors, sample spillage, injection volume changes or
instrument sensitivity changes.</p>
<details><summary>
Exercises
</summary><blockquote>
<p>First, run the code below as it is. What observations can be made?
Then, examine batch 6, by uncommenting the line
<code>#plot_range_indices =</code>. What do you see in this batch?
Identify the potential outlier sample by setting
<code>x_axis_variable = "analysis_id"</code>. Next, set the y-axis
limits manually <code>y_lim = c(-2,2)</code> and display all
analyses/batches again to inspect the data for other trends or
fluctuations.</p>
</blockquote>
</details><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">midar</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_rla_boxplot.html">plot_rla_boxplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">myexp</span>,</span>
<span>  rla_type_batch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"within"</span><span class="op">)</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"intensity"</span>,</span>
<span>  qc_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BQC"</span>, <span class="st">"SPL"</span>, <span class="st">"RQC"</span>, <span class="st">"TQC"</span>, <span class="st">"PBLK"</span><span class="op">)</span>, </span>
<span>  filter_data <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>  <span class="co">#plot_range_indices = get_batch_boundaries(myexp, batch_ids = c(6,6)), </span></span>
<span>  <span class="co">#y_lim = c(-3,3),</span></span>
<span>  show_timestamp <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ignore_outliers <span class="op">=</span> <span class="cn">FALSE</span>, x_gridlines <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  batch_zebra_stripe <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  linewidth <span class="op">=</span> <span class="fl">0.1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="T01_targetlipidomics_workflow_files/figure-html/rla-plot-1.png" alt="RLA plot" width="100%"></p>
</div>
<div class="section level2">
<h2 id="pca-plot-of-all-qc-types">7. PCA plot of all QC types<a class="anchor" aria-label="anchor" href="#pca-plot-of-all-qc-types"></a>
</h2>
<p>A principal component analysis (PCA) plot provides an alternative
method for obtaining an overview of the study and quality control (QC)
samples, as well as for identifying potential issues, such as batch
effects, technical outliers, and differences between the sample
types.</p>
<details><summary>
Exercises
</summary><blockquote>
<p>Add blanks and sample dilutions to the plot, by including
<code>"PBLK", "RQC"</code> to <code>qc_types =</code> below. What do you
think the resulting PCA plot suggests now?</p>
</blockquote>
</details><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_pca.html">plot_pca</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">myexp</span>, </span>
<span>  variable <span class="op">=</span> <span class="st">"feature_intensity"</span>, </span>
<span>  filter_data <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  pca_dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>  labels_threshold_mad <span class="op">=</span> <span class="fl">3</span>, </span>
<span>  qc_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SPL"</span>, <span class="st">"BQC"</span>, <span class="st">"TQC"</span><span class="op">)</span>,</span>
<span>  log_transform <span class="op">=</span> <span class="cn">TRUE</span>,  </span>
<span>  point_size <span class="op">=</span> <span class="fl">2</span>, point_alpha <span class="op">=</span> <span class="fl">0.7</span>, font_base_size <span class="op">=</span> <span class="fl">8</span>, ellipse_alpha <span class="op">=</span> <span class="fl">0.3</span>, </span>
<span>  include_istd <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> <span style="color: #BBBB00;">2 features contained missing or non-numeric values and were exluded.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="color: #00BB00;">The PCA was calculated based on `feature_intensity` values of 423 features.</span></span></span></code></pre></div>
<p><img src="T01_targetlipidomics_workflow_files/figure-html/pca-before-1.png" alt="PCA plot" width="100%"></p>
</div>
<div class="section level2">
<h2 id="exclude-technical-outliers">8. Exclude technical outliers<a class="anchor" aria-label="anchor" href="#exclude-technical-outliers"></a>
</h2>
<p>Based on the above RLA and PCA plots, we flagged a technical outlier
and decided to remove it from all downstream processing via the function
<code>exclude()</code>.</p>
<details><summary>
Exercises
</summary><blockquote>
<p>What do we now see in the new PCA plot? Explore also different PCA
dimensions (by modifying <code>pca_dim</code>).</p>
</blockquote>
</details><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="co"># Exclude the sample from the processing</span></span>
<span><span class="va">myexp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/exclude_analyses.html">exclude_analyses</a></span><span class="op">(</span><span class="va">myexp</span>, analyses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Longit_batch6_51"</span><span class="op">)</span>, clear_existing  <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="color: #00BB00;">1 analyses were excluded for downstream processing. Please reprocess data.</span></span></span>
<span></span>
<span><span class="co"># Replot the PCA</span></span>
<span><span class="fu"><a href="../reference/plot_pca.html">plot_pca</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">myexp</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"intensity"</span>,</span>
<span>  filter_data <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  pca_dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>  labels_threshold_mad <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  qc_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SPL"</span>, <span class="st">"BQC"</span>, <span class="st">"TQC"</span><span class="op">)</span>,</span>
<span>  log_transform <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  point_size <span class="op">=</span> <span class="fl">2</span>, point_alpha <span class="op">=</span> <span class="fl">0.7</span>, font_base_size <span class="op">=</span> <span class="fl">8</span>, ellipse_alpha <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  include_istd <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  shared_labeltext_hide <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> <span style="color: #BBBB00;">2 features contained missing or non-numeric values and were exluded.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="color: #00BB00;">The PCA was calculated based on `feature_intensity` values of 423 features.</span></span></span></code></pre></div>
<p><img src="T01_targetlipidomics_workflow_files/figure-html/outlier-removal-1.png" alt="PCA plot" width="100%"></p>
</div>
<div class="section level2">
<h2 id="response-curves">9. Response curves<a class="anchor" aria-label="anchor" href="#response-curves"></a>
</h2>
<p>A linear response in quantification is a prerequisite for to compared
differences in analyte concentrations between samples. Given the
considerable dynamic range of plasma lipid species abundances and the
fact that the class-specific ISTD is spiked at a single concentration,
verifying the linear response can be a valuable aspect of the analytical
quality assessment. While optimising the injected sample amount is
primarily a matter of quality assurance (QA), differences in instrument
performance can affect the dynamic range. Therefore, we measured
injection volume series at the start and end of this analysis as a
QC.</p>
<details><summary>
Exercises
</summary><blockquote>
<p>Look at the response curves below. What do we see from these results?
Change the plotted lipid species by modifying
<code>include_feature_filter</code> (it can use regular expressions).
Save a PDF of all lipids by setting <code>output_pdf = TRUE</code> and
commenting out (add a <code>#</code> in front of)
<code>include_feature_filter</code></p>
</blockquote>
</details><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Exclude very low abundant features</span></span>
<span><span class="va">myexp</span> <span class="op">&lt;-</span> <span class="fu">midar</span><span class="fu">::</span><span class="fu"><a href="../reference/filter_features_qc.html">filter_features_qc</a></span><span class="op">(</span><span class="va">myexp</span>, </span>
<span>                                   include_qualifier <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                   include_istd <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                   min.intensity.median.spl <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="co">#&gt; Calculating feature QC metrics - please wait...</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #00BB00;">New feature QC filters were defined: 437 of 448 quantifier features meet QC criteria (including the 25 quantifier ISTD features).</span></span></span>
<span></span>
<span><span class="co">#Plot the curves</span></span>
<span><span class="fu"><a href="../reference/plot_responsecurves.html">plot_responsecurves</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">myexp</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"intensity"</span>,</span>
<span>  filter_data <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  include_feature_filter <span class="op">=</span> <span class="st">"^PC 3[0-5]"</span>, <span class="co"># here we use regular expressions</span></span>
<span>  output_pdf <span class="op">=</span> <span class="cn">FALSE</span>, path <span class="op">=</span> <span class="st">"response-curves.pdf"</span>,</span>
<span>  cols_page <span class="op">=</span> <span class="fl">5</span>, rows_page <span class="op">=</span> <span class="fl">4</span>,</span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Registered S3 methods overwritten by 'ggpp':</span></span>
<span><span class="co">#&gt;   method                  from   </span></span>
<span><span class="co">#&gt;   heightDetails.titleGrob ggplot2</span></span>
<span><span class="co">#&gt;   widthDetails.titleGrob  ggplot2</span></span>
<span><span class="co">#&gt; Generating plots (1 page):</span></span>
<span><span class="co">#&gt;   |                                      |                              |   0%</span></span></code></pre></div>
<p><img src="T01_targetlipidomics_workflow_files/figure-html/responsecurves-1.png" alt="Response curve plots" width="100%"></p>
<pre><code><span><span class="co">#&gt;   |                                      |==============================| 100%</span></span>
<span><span class="co">#&gt;  - done!</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="isotope-interference-correction">10. Isotope interference correction<a class="anchor" aria-label="anchor" href="#isotope-interference-correction"></a>
</h2>
<p>As demonstrated in the course presentation, there are several
instances where the peaks of interest were co-integrated with the
interfering isotope peaks of other lipid species. These intereferences
can be subtracted from the raw intensities (areas) using the below
function, which utilises information from the metadata. The relative
abundances for the interfering fragments were obtained using LICAR (<a href="https://github.com/SLINGhub/LICAR" class="external-link uri">https://github.com/SLINGhub/LICAR</a>).</p>
<details><summary>
Exercises
</summary><blockquote>
<p>Check the sheet “Features (Analytes)” in the metadata file (folder
<code>data</code>). Which species were affected? Which information will
you need? Why should we correct for M+3 isotope interference?</p>
</blockquote>
</details><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myexp</span> <span class="op">&lt;-</span> <span class="fu">midar</span><span class="fu">::</span><span class="fu"><a href="../reference/correct_interferences.html">correct_interferences</a></span><span class="op">(</span><span class="va">myexp</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> <span style="color: #BBBB00;">Interference correction led to negative or zero values in 2 feature(s) in samples/QCs. Please verify the correction, or set `neg_to_na = TRUE`</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #00BB00;">Interference-correction has been applied to 10 of the 502 features.</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="normalization-and-quantification-based-on-istds">11. Normalization and quantification based on ISTDs<a class="anchor" aria-label="anchor" href="#normalization-and-quantification-based-on-istds"></a>
</h2>
<p>The first step is to normalize each lipid species with its
corresponding internal standard (ISTD). Subsequently, the concentrations
are calculated based on the volume of the spiked-in ISTD solution, the
concentration of the ISTDs in this solution, and the sample volume.</p>
<details><summary>
Exercises
</summary><blockquote>
<p>Visit the metadata template to view the corresponding details. You
can also try to re-run e.g. above RLA and PCA plots with
<code>variable = "norm_intensity"</code> or
<code>variable = "conc"</code> to plot the normalized data.</p>
</blockquote>
</details><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myexp</span> <span class="op">&lt;-</span> <span class="fu">midar</span><span class="fu">::</span><span class="fu"><a href="../reference/normalize_by_istd.html">normalize_by_istd</a></span><span class="op">(</span><span class="va">myexp</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #00BB00;">460 features normalized with 17 ISTDs in 498 analyses.</span></span></span>
<span><span class="va">myexp</span> <span class="op">&lt;-</span> <span class="fu">midar</span><span class="fu">::</span><span class="fu"><a href="../reference/quantify_by_istd.html">quantify_by_istd</a></span><span class="op">(</span><span class="va">myexp</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #00BB00;">460 feature concentrations calculated based on 42 ISTDs and sample amounts of 498 analyses.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="color: #00BB00;">Concentrations are given in μmol/L.</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="examine-the-effects-of-class-wide-istd-normalization">12. Examine the effects of class-wide ISTD normalization<a class="anchor" aria-label="anchor" href="#examine-the-effects-of-class-wide-istd-normalization"></a>
</h2>
<p>The use of class-specific ISTDs is common practice in lipidomics.
However, non-authentic internal standards may elute at different times,
which can result in them being subject to different matrix effects and
thus different responses compared to the analytes. They may also differ
in their fragmentation properties, which can also affect the response.
Consequently, the use of non-authentic ISTDs for normalization can lead
to the introduction of artefacts, which can manifest as increases in
sample variability, rather than the expected reduction. It it therefore
important to assess ISTDs during QA in particular, but also as QC, and
to consider using alternative ISTDs when observing artefacts. One
approach to detecting potential ISTD-related artefacts is to compare the
variability of QC and samples before and after normalization.</p>
<details><summary>
Exercises
</summary><blockquote>
<p>What would you expect from such comarisons of CV? Do you notice
potential issues with any of the ISTDs below? What could be possible
explanations for such an effect? And what would you do in this
situation?</p>
</blockquote>
</details><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myexp</span> <span class="op">&lt;-</span> <span class="fu">midar</span><span class="fu">::</span><span class="fu"><a href="../reference/filter_features_qc.html">filter_features_qc</a></span><span class="op">(</span><span class="va">myexp</span>, </span>
<span>                                   include_qualifier <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                   include_istd <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                   min.intensity.median.spl <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="co">#&gt; Calculating feature QC metrics - please wait...</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #00BB00;">New feature QC filters were defined: 413 of 448 quantifier features meet QC criteria (including the 25 quantifier ISTD features).</span></span></span>
<span><span class="fu">midar</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_normalization_qc.html">plot_normalization_qc</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">myexp</span>, </span>
<span>  filter_data <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>  facet_by_class <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  qc_type <span class="op">=</span> <span class="st">"SPL"</span>, </span>
<span>  before_norm_var <span class="op">=</span> <span class="st">"intensity"</span>, </span>
<span>  after_norm_var <span class="op">=</span> <span class="st">"norm_intensity"</span><span class="op">)</span></span></code></pre></div>
<p><img src="T01_targetlipidomics_workflow_files/figure-html/norm-effects-1.png" alt="Normalization QC plot" width="100%"></p>
</div>
<div class="section level2">
<h2 id="drift-correction">13. Drift correction<a class="anchor" aria-label="anchor" href="#drift-correction"></a>
</h2>
<p>We’re going to use a Gaussian kernel smoothing based on the study
sample to correct for any drifts in the concentration data within each
batch. The summary return by the function below isn’t meant as actual
diagnostics of the fit, but rather to understand if the fit caused any
major artefacts. There is also an option to scale along the fit by
setting <code>scale_smooth = TRUE</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">myexp</span> <span class="op">&lt;-</span> <span class="fu">midar</span><span class="fu">::</span><span class="fu"><a href="../reference/correct_drift_gaussiankernel.html">correct_drift_gaussiankernel</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">myexp</span>,</span>
<span>  ignore_istd <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"conc"</span>,</span>
<span>  ref_qc_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SPL"</span><span class="op">)</span>,</span>
<span>  batch_wise <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  replace_previous <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  recalc_trend_after <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  kernel_size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  outlier_filter <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  outlier_ksd <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  location_smooth <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  scale_smooth <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>  show_progress <span class="op">=</span> <span class="cn">FALSE</span>  <span class="co"># set to FALSE when rendering</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="color: #00BB00;">Applying `conc` drift correction...</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="color: #BBBB00;">4 feature(s) contain one or more zero or negative `conc` values. Verify your data or use `log_transform_internal = FALSE`.</span></span></span>
<span><span class="co">#&gt;   |                                                    |                                            |   0%  |                                                    |=                                           |   2%  |                                                    |==                                          |   4%  |                                                    |===                                         |   6%  |                                                    |====                                        |   8%  |                                                    |====                                        |  10%  |                                                    |=====                                       |  12%  |                                                    |======                                      |  14%  |                                                    |=======                                     |  16%  |                                                    |========                                    |  18%  |                                                    |=========                                   |  20%  |                                                    |==========                                  |  22%  |                                                    |===========                                 |  24%  |                                                    |============                                |  26%  |                                                    |============                                |  28%  |                                                    |=============                               |  30%  |                                                    |==============                              |  32%  |                                                    |===============                             |  34%  |                                                    |================                            |  37%  |                                                    |=================                           |  39%  |                                                    |==================                          |  41%  |                                                    |===================                         |  43%  |                                                    |====================                        |  45%  |                                                    |=====================                       |  47%  |                                                    |=====================                       |  49%  |                                                    |======================                      |  51%  |                                                    |=======================                     |  53%  |                                                    |========================                    |  55%  |                                                    |=========================                   |  57%  |                                                    |==========================                  |  59%  |                                                    |===========================                 |  61%  |                                                    |============================                |  63%  |                                                    |=============================               |  65%  |                                                    |=============================               |  67%  |                                                    |==============================              |  69%  |                                                    |===============================             |  71%  |                                                    |================================            |  73%  |                                                    |=================================           |  75%  |                                                    |==================================          |  77%  |                                                    |===================================         |  79%  |                                                    |====================================        |  81%  |                                                    |=====================================       |  83%  |                                                    |=====================================       |  85%  |                                                    |======================================      |  87%  |                                                    |=======================================     |  89%  |                                                    |========================================    |  91%  |                                                    |=========================================   |  93%  |                                                    |==========================================  |  95%  |                                                    |=========================================== |  97%  |                                                    |============================================|  99%  |                                                    |============================================| 100%<span style="color: #00BB00;"> - trend smoothing done!</span></span></span>
<span><span class="co">#&gt;   |                                                    |                                            |   0%  |                                                    |=                                           |   2%  |                                                    |==                                          |   4%  |                                                    |===                                         |   6%  |                                                    |====                                        |   8%  |                                                    |====                                        |  10%  |                                                    |=====                                       |  12%  |                                                    |======                                      |  14%  |                                                    |=======                                     |  16%  |                                                    |========                                    |  18%  |                                                    |=========                                   |  20%  |                                                    |==========                                  |  22%  |                                                    |===========                                 |  24%  |                                                    |============                                |  26%  |                                                    |============                                |  28%  |                                                    |=============                               |  30%  |                                                    |==============                              |  32%  |                                                    |===============                             |  34%  |                                                    |================                            |  37%  |                                                    |=================                           |  39%  |                                                    |==================                          |  41%  |                                                    |===================                         |  43%  |                                                    |====================                        |  45%  |                                                    |=====================                       |  47%  |                                                    |=====================                       |  49%  |                                                    |======================                      |  51%  |                                                    |=======================                     |  53%  |                                                    |========================                    |  55%  |                                                    |=========================                   |  57%  |                                                    |==========================                  |  59%  |                                                    |===========================                 |  61%  |                                                    |============================                |  63%  |                                                    |=============================               |  65%  |                                                    |=============================               |  67%  |                                                    |==============================              |  69%  |                                                    |===============================             |  71%  |                                                    |================================            |  73%  |                                                    |=================================           |  75%  |                                                    |==================================          |  77%  |                                                    |===================================         |  79%  |                                                    |====================================        |  81%  |                                                    |=====================================       |  83%  |                                                    |=====================================       |  85%  |                                                    |======================================      |  87%  |                                                    |=======================================     |  89%  |                                                    |========================================    |  91%  |                                                    |=========================================   |  93%  |                                                    |==========================================  |  95%  |                                                    |=========================================== |  97%  |                                                    |============================================|  99%  |                                                    |============================================| 100%<span style="color: #00BB00;"> - trend recalc done!</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> <span style="color: #BBBB00;">1 features showed no variation in the study sample's original values across analyses. </span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> <span style="color: #BBBB00;">1 features have invalid values after smoothing. NA will be be returned for all values of these faetures. Set `use_original_if_fail = FALSE to return orginal values..</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #00BB00;">Drift correction was applied to 459 of 460 features (batch-wise).</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="color: #555555;">The median CV change of all features in study samples was </span><span style="color: #555555; font-weight: bold;">-1.00%</span><span style="color: #555555;"> (range: -12.53% to 2.59%). The median absolute CV of all features across batches </span><span style="color: #555555; font-weight: bold;">decreased from</span><span style="color: #555555;"> </span><span style="color: #555555; font-weight: bold;">39.00% to 37.71%</span><span style="color: #555555;">.</span></span></span></code></pre></div>
<p>In order to demonstrate the correction, we will plot an example (PC
40:8) before and after the drift and batch correction. As we will be
using the same plot on several occasions, we create a simple function
that wraps the plot with many parameters preset.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define a wrapper function</span></span>
<span></span>
<span><span class="va">my_trend_plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">variable</span>, <span class="va">feature</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/plot_runscatter.html">plot_runscatter</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">myexp</span>,</span>
<span>    variable <span class="op">=</span> <span class="va">variable</span>,</span>
<span>    qc_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BQC"</span>, <span class="st">"TQC"</span>, <span class="st">"SPL"</span><span class="op">)</span>,</span>
<span>    include_feature_filter <span class="op">=</span> <span class="va">feature</span>,</span>
<span>    exclude_feature_filter <span class="op">=</span> <span class="st">"ISTD"</span>,</span>
<span>    cap_outliers <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    log_scale <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    show_trend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    output_pdf <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    path <span class="op">=</span> <span class="st">"./output/runscatter_PC408_beforecorr.pdf"</span>,</span>
<span>    cols_page <span class="op">=</span> <span class="fl">1</span>, rows_page <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<details><summary>
Exercises
</summary><blockquote>
<p>Let’s use this before defined function to plot the trends of one
selected example before and after within-batch smoothing. What may have
caused such a drift in the raw concentrations? Do the QC samples follow
the trend of the sample? Look also at other lipid species.</p>
<p>Try changing <code>batch_wise = FALSE</code> in the code chunk above
with <code><a href="../reference/correct_drift_gaussiankernel.html">correct_drift_gaussiankernel()</a></code> to run the run the
smoothing across all batches. Would this be a valid alternative? NOTE:
don’t forget to change back to <code>batch_wise = TRUE</code> after the
test.</p>
</blockquote>
</details><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">my_trend_plot</span><span class="op">(</span><span class="st">"conc_before"</span>, <span class="st">"PC 40:8"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Generating plots (1 page)...</span></span></span></code></pre></div>
<p><img src="T01_targetlipidomics_workflow_files/figure-html/plot-trends-1.png" alt="RunScatter plots with trends before after corrections  " width="100%"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;"> - done!</span></span></span>
<span><span class="fu">my_trend_plot</span><span class="op">(</span><span class="st">"conc"</span>, <span class="st">"PC 40:8"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Generating plots (1 page)...</span></span></span></code></pre>
<p><img src="T01_targetlipidomics_workflow_files/figure-html/plot-trends-2.png" alt="RunScatter plots with trends before after corrections  " width="100%"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;"> - done!</span></span></span></code></pre>
</div>
<div class="section level2">
<h2 id="batch-effect-correction">14. Batch-effect correction<a class="anchor" aria-label="anchor" href="#batch-effect-correction"></a>
</h2>
<p>As we observed, the trend lines of the different batches are not
aligned. We will use <code>correct_batcheffects()</code> to correct for
median center (location) and scale differences between the batches. The
define that the correction should be based on the study samples medians.
An optional scale correction can be performed by setting
<code>correct_scale = FALSE</code>. After the correction we directly
plot our example lipid species again.</p>
<details><summary>
Exercises
</summary><blockquote>
<p>Change the sample type to <code>qc_type = "BQC"</code> to use the BQC
to center the batches. What do you observe?</p>
</blockquote>
</details><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myexp</span> <span class="op">&lt;-</span> <span class="fu">midar</span><span class="fu">::</span><span class="fu"><a href="../reference/correct_batch_centering.html">correct_batch_centering</a></span><span class="op">(</span></span>
<span>  <span class="va">myexp</span>, </span>
<span>  variable <span class="op">=</span> <span class="st">"conc"</span>,</span>
<span>  ref_qc_types <span class="op">=</span> <span class="st">"SPL"</span>,</span>
<span>  replace_previous <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  correct_location <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>  correct_scale <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>  log_transform_internal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="color: #BBBB00;">Adding batch correction on top of `conc` drift-correction.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #00BB00;">Batch median-centering of 6 batches was applied to drift-corrected concentrations of all 460 features.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="color: #555555;">The median CV change of all features in study samples was </span><span style="color: #555555; font-weight: bold;">-0.29%</span><span style="color: #555555;"> (range: -31.80% to 69.10%).  The median absolute CV of all features </span><span style="color: #555555; font-weight: bold;">increased from</span><span style="color: #555555;"> </span><span style="color: #555555; font-weight: bold;">39.12% to 39.44%</span><span style="color: #555555;">.</span></span></span>
<span></span>
<span><span class="fu">my_trend_plot</span><span class="op">(</span><span class="st">"conc"</span>, <span class="st">"PC 40:8"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Generating plots (1 page)...</span></span></span></code></pre></div>
<p><img src="T01_targetlipidomics_workflow_files/figure-html/batch-effect-corr-1.png" alt="RunScatter plots with trends after corrections" width="100%"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;"> - done!</span></span></span></code></pre>
</div>
<div class="section level2">
<h2 id="saving-runscatter-plots-of-all-features-as-pdf">15. Saving <em>runscatter</em> plots of all features as PDF<a class="anchor" aria-label="anchor" href="#saving-runscatter-plots-of-all-features-as-pdf"></a>
</h2>
<p>For additional inspection and documentation, we can save plots for
all or a selected subset of species. It is often preferable to exclude
blanks, as they can exhibit random concentrations when signals of
features and internal standards are in close proximity or below the
limit of detection. The corresponding PDF can be accessed within the
<code>output</code> subfolder. Use <code>filt_</code> arguments to
include or exclude specific analytes. The filter can use regular
expressions (regex). (Hint: try using ChatGPT to generate more complex
regex-based filters).</p>
<details><summary>
Exercises
</summary><p>Explore the effect of setting <code>cap_outliers</code> to
<code>TRUE</code>or <code>FALSE</code>. Run <code>?runscatter</code> in
the console or press <code>F2</code> on the function name to see all
available options for <code><a href="../reference/plot_runscatter.html">plot_runscatter()</a></code>.</p>
</details><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_runscatter.html">plot_runscatter</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">myexp</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"conc"</span>,</span>
<span>  qc_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BQC"</span>, <span class="st">"TQC"</span>, <span class="st">"SPL"</span><span class="op">)</span>,</span>
<span>  include_feature_filter <span class="op">=</span>  <span class="cn">NA</span>,</span>
<span>  exclude_feature_filter <span class="op">=</span> <span class="st">"ISTD"</span>,</span>
<span>  cap_outliers <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  log_scale <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show_trend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  output_pdf <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  path <span class="op">=</span> <span class="st">"./output/runscatter_after-drift-batch-correction.pdf"</span>,</span>
<span>  cols_page <span class="op">=</span> <span class="fl">2</span>, </span>
<span>  rows_page <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  show_progress <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="qc-based-feature-filtering">16. QC-based feature filtering<a class="anchor" aria-label="anchor" href="#qc-based-feature-filtering"></a>
</h2>
<p>Finally, we apply a set of filters to exclude features that don’t
meet specific QC criteria. The available criteria can be seen by
pressing <code>TAB</code> after the first open bracket of
<code><a href="../reference/filter_features_qc.html">filter_features_qc()</a></code> function, or by to viewing the help
page. by running <code><a href="../reference/filter_features_qc.html">?filter_features_qc</a></code> in the console. The
filter function can be applied multiple times, either overwriting or
amending (<code>clear_existing = FALSE</code>) previously set
filters.</p>
<details><summary>
Exercises
</summary><blockquote>
<p>Explore the effects of the different filtering criteria and filtering
thresholds. The plot below in section 17 can be run in order to examine
the effects visually.</p>
</blockquote>
</details><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">myexp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_features_qc.html">filter_features_qc</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">myexp</span>, </span>
<span>  clear_existing <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  use_batch_medians <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  include_qualifier <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  include_istd <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  response.curves.selection <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>  response.curves.summary <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  min.rsquare.response <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  min.slope.response <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  max.yintercept.response <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  min.signalblank.median.spl.pblk <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  min.intensity.median.spl <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  max.cv.conc.bqc <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  features.to.keep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CE 20:4"</span>, <span class="st">"CE 22:5"</span>, <span class="st">"CE 22:6"</span>, <span class="st">"CE 16:0"</span>, <span class="st">"CE 18:0"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Calculating feature QC metrics - please wait...</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> <span style="color: #BBBB00;">The following features were forced to be retained despite not meeting filtering criteria: CE 16:0, CE 20:4, CE 22:5, and CE 22:6</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #00BB00;">New feature QC filters were defined: 324 of 423 quantifier features meet QC criteria (not including the 25 quantifier ISTD features).</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="summary-of-the-qc-filtering">17. Summary of the QC filtering<a class="anchor" aria-label="anchor" href="#summary-of-the-qc-filtering"></a>
</h2>
<p>The plot below provides an overview of the data quality and the
feature filtering. The segments in green indicate the number of species
that passed all previously defined quality control (QC) filtering
criteria. The rest are the number of species that failed the different
filtering criteria. It should be noted that the criteria are
hierarchically organised; a feature is only classified as failing a
criterion (e.g., <code>CV</code>) when it has passed the hierarchically
lower filters (e.g., <code>S/B</code> and <code>LOD</code>).</p>
<details><summary>
Exercises
</summary><blockquote>
<p>Are there any differences between lipid classes in terms of their
analytical performance? What are the identified QC issues and what are
possible explanations for these? What could be the implications if you
want to run the next analysis?</p>
</blockquote>
</details><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">midar</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_qc_summary_byclass.html">plot_qc_summary_byclass</a></span><span class="op">(</span><span class="va">myexp</span><span class="op">)</span></span></code></pre></div>
<p><img src="T01_targetlipidomics_workflow_files/figure-html/qc-summary-1-1.png" alt="Feature QC filter plot by class" width="100%"></p>
<p>The following plot provides a further summary of the feature
filtering process, indicating the total number of features that have
been successfully filtered. As previously stated, the classification is
based on the hierarchical application of filters. The Venn diagram on
the right illustrates the number of features that have been excluded by
a particular filtering criterion.</p>
<details><summary>
Exercises
</summary><blockquote>
<p>Take a look at the Venn diagram. If a feature shows a bad or
non-linear response (e.g. r2 &lt; 0.8), what could be the reasons for
this?</p>
</blockquote>
</details><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">midar</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_qc_summary_overall.html">plot_qc_summary_overall</a></span><span class="op">(</span><span class="va">myexp</span><span class="op">)</span></span></code></pre></div>
<p><img src="T01_targetlipidomics_workflow_files/figure-html/qc-summary-2-1.png" alt="Feature QC filter plot overall" width="100%"></p>
</div>
<div class="section level2">
<h2 id="saving-a-report-with-data-metadata-and-processing-details">18. Saving a report with data, metadata and processing details<a class="anchor" aria-label="anchor" href="#saving-a-report-with-data-metadata-and-processing-details"></a>
</h2>
<p>A detailed summary of the data post-processing can be generated in
the form of an formatted <code>Excel</code> workbook comprising multiple
sheets, each containing raw and processed datasets, associated metadata,
feature quality control metrics, and information about the applied
processing steps.</p>
<details><summary>
Exercises
</summary><blockquote>
<p>Explore the report that was saved in the <code>output</code>
folder.</p>
</blockquote>
</details><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">midar</span><span class="fu">::</span><span class="fu"><a href="../reference/save_report_xlsx.html">save_report_xlsx</a></span><span class="op">(</span><span class="va">myexp</span>, path <span class="op">=</span> <span class="st">"./output/myexp-midar_report.xlsx"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Saving report to disk - please wait...</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #00BB00;">The data processing report of experiment 'sPerfect' has been saved to './output/myexp-midar_report.xlsx'.</span></span></span></code></pre></div>
<p>You can also save specific data subsets as a clean flat, wide CSV
file. This is how we shared the data for the statistical analysis that
will be presented in the next part of this workshop!</p>
<details><summary>
Exercises
</summary><blockquote>
<p>Specify which data to export using function arguments and check the
generated CSV files.</p>
</blockquote>
</details><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">midar</span><span class="fu">::</span><span class="fu"><a href="../reference/save_dataset_csv.html">save_dataset_csv</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">myexp</span>, </span>
<span>  path <span class="op">=</span> <span class="st">"./output/sperfect_filt_uM.csv"</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"conc"</span>, </span>
<span>  qc_types <span class="op">=</span> <span class="st">"SPL"</span>, </span>
<span>  include_qualifier <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  filter_data <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #00BB00;">Concentration values for 377 analyses and 324 features have been exported to './output/sperfect_filt_uM.csv'.</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sharing-the-midarexperiment-dataset">19. Sharing the <code>MidarExperiment</code> dataset<a class="anchor" aria-label="anchor" href="#sharing-the-midarexperiment-dataset"></a>
</h2>
<p>The <code>myexp</code> object can be saved as an <code>RDS</code>
file and shared. <code>RDS</code> files are serialized R
variables/objects that can be opened in R by anyone, even in the absence
of <code>midar</code> package. The imported <code>MidarExperiment</code>
object can also be utilized for re-processing, plotting, or inspection
using the <code>midar</code> package.</p>
<details><summary>
Exercises
</summary><blockquote>
<p>Save the dataset to the disk and re-open it under a different name.
Check the status comparing it with the dataset generated in the workflow
above (<code>mexp</code>)</p>
</blockquote>
</details><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">myexp</span>, file <span class="op">=</span> <span class="st">"./output/myexp-midar.rds"</span>, compress <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">my_saved_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"./output/myexp-midar.rds"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">myexp</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">MidarExperiment</span> <span style="color: #00BBBB;">─────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">Title: </span><span style="color: #0000BB; font-weight: bold;">sPerfect</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">Processing status: </span><span style="color: #0000BB; font-weight: bold;">Drift-Batch-corrected concentrations</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Annotated Raw Data</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; • Analyses: 498</span></span>
<span><span class="co">#&gt; • Features: 502</span></span>
<span><span class="co">#&gt; • Raw signal used for processing: `feature_area`</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Metadata</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; • Analyses/samples: <span style="color: #00BB00; font-weight: bold;">✔</span></span></span>
<span><span class="co">#&gt; • Features/analytes: <span style="color: #00BB00; font-weight: bold;">✔</span></span></span>
<span><span class="co">#&gt; • Internal standards: <span style="color: #00BB00; font-weight: bold;">✔</span></span></span>
<span><span class="co">#&gt; • Response curves: <span style="color: #00BB00; font-weight: bold;">✔</span></span></span>
<span><span class="co">#&gt; • Calibrants/QC concentrations: <span style="color: #BB0000; font-weight: bold;">✖</span></span></span>
<span><span class="co">#&gt; • Study samples: <span style="color: #BB0000; font-weight: bold;">✖</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Processing Status</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; • Isotope corrected: <span style="color: #00BB00;">✔</span></span></span>
<span><span class="co">#&gt; • ISTD normalized: <span style="color: #00BB00;">✔</span></span></span>
<span><span class="co">#&gt; • ISTD quantitated: <span style="color: #00BB00;">✔</span></span></span>
<span><span class="co">#&gt; • Drift corrected variables: `feature_conc`</span></span>
<span><span class="co">#&gt; • Batch corrected variables: `feature_conc`</span></span>
<span><span class="co">#&gt; • Feature filtering applied: <span style="color: #00BB00;">✔</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Exclusion of Analyses and Features</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; • Analyses manually excluded (`analysis_id`): <span style="color: #BB0000;">Longit_batch6_51</span></span></span>
<span><span class="co">#&gt; • Features manually excluded (`feature_id`): <span style="color: #BB0000;">✖</span></span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bo Burla.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
