<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Metadata import • midar</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Metadata import">
<meta name="description" content="MiDAR: postprocessing and quality control of small molecule mass spectrometry data
">
<meta property="og:description" content="MiDAR: postprocessing and quality control of small molecule mass spectrometry data
">
<meta property="og:image" content="https://slinghub.github.io/midar/logo.svg">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">midar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/00_get_started.html">Getting started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials-recipes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials &amp; Recipes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials-recipes">
<li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/T01_prepdata.html">Preparing and importing data</a></li>
    <li><a class="dropdown-item" href="../articles/T02_settingup_workflow.html">Setting Up a Basic MiDAR Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/T01_targetlipidomics_workflow.html">Targeted lipidomics with QC</a></li>
    <li><a class="dropdown-item" href="../articles/T_DriftCorrect.html">Drift Correction</a></li>
    <li><a class="dropdown-item" href="../articles/T_BatchCorrect.html">Batch Correction</a></li>
    <li><a class="dropdown-item" href="../articles/T_CalibRef.html">Calibration by a Reference Sample</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Recipes</h6></li>
    <li><a class="dropdown-item" href="../articles/R01_quantms.html">External Calibration and QC</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-manual" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Manual</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-manual">
<li><h6 class="dropdown-header" data-toc-skip>Key Concepts</h6></li>
    <li><a class="dropdown-item" href="../articles/01_datastructure.html">Data Structures</a></li>
    <li><a class="dropdown-item" href="../articles/02_keydataids.html">Data Indentifier</a></li>
    <li><a class="dropdown-item" href="../articles/02b_keyfeaturevar.html">Feature Variables</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Data and Metadata</h6></li>
    <li><a class="dropdown-item" href="../articles/03_midarexperiment.html">MidarExperiment Object</a></li>
    <li><a class="dropdown-item" href="../articles/04_dataimport.html">Data Import</a></li>
    <li><a class="dropdown-item" href="../articles/05_metadataimport.html">Metadata Import</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/07_driftbatchcorr.html">Batch/Drift Correction</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SLINGhub/midar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Metadata import</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/SLINGhub/midar/blob/HEAD/vignettes/articles/05_metadataimport.Rmd" class="external-link"><code>vignettes/articles/05_metadataimport.Rmd</code></a></small>
      <div class="d-none name"><code>05_metadataimport.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="metadata">Metadata<a class="anchor" aria-label="anchor" href="#metadata"></a>
</h3>
<p>Metadata in this context refers to analysis metadata, i.e., data that
annotate the analytical data. Metadata can be retrieved from the
imported analysis data file as far as available, or can be imported from
separate files or R data frames.</p>
<p>Integrity of metadata and data is instrumental for correct and smooth
post processing of data. Midar therefore inspects imported data/metadata
for completness of data and consistency of IDs used across differet
metadata tables. After importing metadata a summary of identified error,
warnings and notes cocerning metadata is printed to the console, to
allow user to identify and adress possible issues.</p>
</div>
<div class="section level3">
<h3 id="metadata-formats-and-temples">Metadata formats and temples<a class="anchor" aria-label="anchor" href="#metadata-formats-and-temples"></a>
</h3>
<p>The structure and required/optional columns for each metadata type is
descrived in the Manual and in the help of the correspoding import
functions.</p>
<p>To obtain templates for metadata, a Excel file containing all
template metadata table templates can be saved.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">midar</span><span class="fu">::</span><span class="fu"><a href="../reference/save_metadata_templates.html">save_metadata_templates</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="importing-metadata-from-filessheets">Importing metadata from files/sheets<a class="anchor" aria-label="anchor" href="#importing-metadata-from-filessheets"></a>
</h3>
<p>First we import the analysis data as outlined in “Importing data”. In
this case we explicitly do not not import any metadata present in the
analysis data, i.e., we only import the peak areas.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/SLINGhub/midar" class="external-link">midar</a></span><span class="op">)</span></span>
<span><span class="va">mexp</span> <span class="op">&lt;-</span> <span class="fu">midar</span><span class="fu">::</span><span class="fu"><a href="../reference/MidarExperiment.html">MidarExperiment</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_path</span> <span class="op">&lt;-</span> <span class="st">"datasets/sPerfect_MRMkit.tsv"</span></span>
<span><span class="va">mexp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/import_data_mrmkit.html">import_data_mrmkit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mexp</span>, path <span class="op">=</span> <span class="va">data_path</span>, import_metadata <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Now we can add corresponding metadata file-by-file</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mexp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/import_metadata_analyses.html">import_metadata_analyses</a></span><span class="op">(</span><span class="va">mexp</span>, </span>
<span>                                 path <span class="op">=</span> <span class="st">"datasets/analysis_metadata.csv"</span>, </span>
<span>                                 excl_unmatched_analyses <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                 ignore_warnings <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mexp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/import_metadata_features.html">import_metadata_features</a></span><span class="op">(</span><span class="va">mexp</span>, </span>
<span>                                 path <span class="op">=</span> <span class="st">"datasets/feature_metadata.csv"</span>,</span>
<span>                                 ignore_warnings<span class="op">=</span> <span class="cn">TRUE</span> <span class="op">)</span></span></code></pre></div>
<p>Metadata can also be imported from sheets of an Excel workbook, which
allows to store all metadata in one file.<br>
In this case below we add metadata on internal standard and response
curves to the MidarExperiment object</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mexp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/import_metadata_istds.html">import_metadata_istds</a></span><span class="op">(</span><span class="va">mexp</span>, </span>
<span>                              path <span class="op">=</span> <span class="st">"datasets/metadata_tables.xlsx"</span>, </span>
<span>                              sheet <span class="op">=</span> <span class="st">"ISTDs"</span>,</span>
<span>                              ignore_warnings<span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Furthermore, metadata can be imported from R <code>data.frame</code>
objects, thus allowing users to obtain metadata from additional sources,
e.g. from databases or a LIMS.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_qcinfo</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_table.html" class="external-link">read_table</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"datasets/qc_metadata.txt"</span><span class="op">)</span></span>
<span><span class="va">mexp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/import_metadata_qcconcentrations.html">import_metadata_qcconcentrations</a></span><span class="op">(</span><span class="va">mexp</span>, table <span class="op">=</span> <span class="va">df_qcinfo</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="importing-msorganiser-metedata-file-template">Importing MSOrganiser metedata file template<a class="anchor" aria-label="anchor" href="#importing-msorganiser-metedata-file-template"></a>
</h3>
<p>Another option to import metadata is via the MSOrganiser template
file, a macro-based (XLSM) Excel file. This template offers tables for
all metadata types supported by MiDAR, with options to do perform checks
on validatiy and integrity of the metadata.</p>
<p>The template can be obtained from <a href="https://github.com/SLINGhub/midar" class="external-link uri">https://github.com/SLINGhub/midar</a> or via a midar
function</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">midar</span><span class="fu">::</span><span class="fu"><a href="../reference/save_metadata_msorganiser_template.html">save_metadata_msorganiser_template</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Only the metadata tables required by the intended processing workflow
need to be completed. With following import function all completed
tables will be imported.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mexp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/import_metadata_msorganiser.html">import_metadata_msorganiser</a></span><span class="op">(</span><span class="va">mexp</span>, </span>
<span>                                    path <span class="op">=</span> <span class="st">"datasets/sPerfect_Metadata.xlsm"</span>,</span>
<span>                                    ignore_warnings<span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="section"></h3>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bo Burla.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
