<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Run-order Drift Correction (Smoothing) • midar</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Run-order Drift Correction (Smoothing)">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">midar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.5.9003</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/00_get_started.html">Get started</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials-recipes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials/Recipes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials-recipes">
<li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/T01_prepdata.html">Preparing and importing data</a></li>
    <li><a class="dropdown-item" href="../articles/T02_settingup_workflow.html">Setting Up a Basic MiDAR Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/T01_targetlipidomics_workflow.html">Targeted lipidomics with QC</a></li>
    <li><a class="dropdown-item" href="../articles/T_DriftCorrect.html">Drift Correction</a></li>
    <li><a class="dropdown-item" href="../articles/T_BatchCorrect.html">Batch Correction</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Recipes</h6></li>
    <li><a class="dropdown-item" href="../articles/R01_quantms.html">External Calibration and QC</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-manual" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Manual</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-manual">
<li><h6 class="dropdown-header" data-toc-skip>Key Concepts</h6></li>
    <li><a class="dropdown-item" href="../articles/01_datastructure.html">Data Structures</a></li>
    <li><a class="dropdown-item" href="../articles/02_keydataids.html">Data Indentifier</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Data and Metadata</h6></li>
    <li><a class="dropdown-item" href="../articles/03_midarexperiment.html">MidarExperiment Object</a></li>
    <li><a class="dropdown-item" href="../articles/04_dataimport.html">Data Import</a></li>
    <li><a class="dropdown-item" href="../articles/05_metadataimport.html">Metadata Import</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/07_driftbatchcorr.html">Batch/Drift Correction</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SLINGhub/midar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Run-order Drift Correction (Smoothing)</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/SLINGhub/midar/blob/HEAD/vignettes/articles/T_DriftCorrect.Rmd" class="external-link"><code>vignettes/articles/T_DriftCorrect.Rmd</code></a></small>
      <div class="d-none name"><code>T_DriftCorrect.Rmd</code></div>
    </div>

    
    
<p>MiDAR provides different functions for run-order drift correction,
differing by the employed smoothing algorithm. These functions can be
categorized into functions that are either more suited for QC or study
sample-based drift correction.</p>
<p>The data must be provided via a MidarExperiment object, whereby raw
data that was imported or processed data can be corrected, such as
<code>intensity</code> or <code>conc</code> values.</p>
<p>These drift correction functions have various options for
customization, please refer the manual page on <a href="07_driftbatchcorr.html">Drift and Batch Correction</a> for more
details.</p>
<div class="section level2">
<h2 id="import-data">Import data<a class="anchor" aria-label="anchor" href="#import-data"></a>
</h2>
<p>In this tutorial, we import pre-calculcated raw oncentration values
from a CSV file. This file must contain a column with batch information
(<code>batch_id</code>) if batch-wise correction should be applied, see
<code><a href="../reference/import_data_csv.html">import_data_csv()</a></code> for more information.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/SLINGhub/midar" class="external-link">midar</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">myexp</span> <span class="op">&lt;-</span> <span class="fu">midar</span><span class="fu">::</span><span class="fu"><a href="../reference/MidarExperiment.html">MidarExperiment</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">myexp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/import_data_csv.html">import_data_csv</a></span><span class="op">(</span></span>
<span>  <span class="va">myexp</span>,</span>
<span>  path <span class="op">=</span> <span class="st">"smooth-testdata.csv"</span>, </span>
<span>  variable_name <span class="op">=</span> <span class="st">"conc"</span>, </span>
<span>  import_metadata <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="qc-based-smoothing">QC-based smoothing<a class="anchor" aria-label="anchor" href="#qc-based-smoothing"></a>
</h2>
<p>Now we apply a QC-based drift correction using cubic spline. See
<code><a href="../reference/correct_drift_cubicspline.html">correct_drift_cubicspline()</a></code> for more information.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mexp_drift</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/correct_drift_cubicspline.html">correct_drift_cubicspline</a></span><span class="op">(</span></span>
<span>  <span class="va">myexp</span>,</span>
<span>  batch_wise <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"conc"</span>,</span>
<span>  ref_qc_types <span class="op">=</span> <span class="st">"BQC"</span>,</span>
<span>  recalc_trend_after <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="color: #00BB00;">Applying `conc` drift correction...</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #00BB00;">Drift correction was applied to 3 of 3 features (across all batches).</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="color: #555555;">The median CV change of all features in study samples was </span><span style="color: #555555; font-weight: bold;">-4.69%</span><span style="color: #555555;"> (range: -8.21% to 1.17%). The median absolute CV of all features </span><span style="color: #555555; font-weight: bold;">decreased from</span><span style="color: #555555;"> </span><span style="color: #555555; font-weight: bold;">30.56% to 28.52%</span><span style="color: #555555;">.</span></span></span></code></pre></div>
<p>Next, we inspect the data before and after the correction. We observe
that the green trendline follows the QC samples (in red). After the
correction, the trend has been fully smoothed out, resulting in a
straight line.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_runscatter.html">plot_runscatter</a></span><span class="op">(</span><span class="va">mexp_drift</span>, variable <span class="op">=</span> <span class="st">"conc_before"</span>, qc_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BQC"</span>, <span class="st">"SPL"</span><span class="op">)</span>,</span>
<span>                rows_page <span class="op">=</span> <span class="fl">1</span>, cols_page <span class="op">=</span> <span class="fl">3</span>, show_trend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Generating plots (1 page)...</span></span></span></code></pre></div>
<p><img src="T_DriftCorrect_files/figure-html/unnamed-chunk-3-1.png" alt="RunScatter plots before and after batch correction
" width="700"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;"> - done!</span></span></span>
<span><span class="fu"><a href="../reference/plot_runscatter.html">plot_runscatter</a></span><span class="op">(</span><span class="va">mexp_drift</span>, variable <span class="op">=</span> <span class="st">"conc"</span>, qc_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BQC"</span>, <span class="st">"SPL"</span><span class="op">)</span>,</span>
<span>                rows_page <span class="op">=</span> <span class="fl">1</span>, cols_page <span class="op">=</span> <span class="fl">3</span>, show_trend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Generating plots (1 page)...</span></span></span></code></pre>
<p><img src="T_DriftCorrect_files/figure-html/unnamed-chunk-3-2.png" alt="RunScatter plots before and after batch correction
" width="700"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;"> - done!</span></span></span></code></pre>
</div>
<div class="section level2">
<h2 id="sample-trend-based-smoothing">Sample trend-based smoothing<a class="anchor" aria-label="anchor" href="#sample-trend-based-smoothing"></a>
</h2>
<p>Above, we observe that the QC samples do not fully represent the
trends of the study samples. This discrepancy can occur when the QC
samples, which often based on pooled samples, differ in handling or
properties from the study samples.</p>
<p>We therefore now try a sample-based drift correction gaussian kernel
smoothing. See <code>correct_drift_gaussiankernel)</code> for more
information.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mexp_drift</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/correct_drift_gaussiankernel.html">correct_drift_gaussiankernel</a></span><span class="op">(</span></span>
<span>  <span class="va">myexp</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"conc"</span>,</span>
<span>  kernel_size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  batch_wise <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ref_qc_types <span class="op">=</span> <span class="st">"SPL"</span>,</span>
<span>  recalc_trend_after <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="color: #00BB00;">Applying `conc` drift correction...</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #00BB00;">Drift correction was applied to 3 of 3 features (across all batches).</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="color: #555555;">The median CV change of all features in study samples was </span><span style="color: #555555; font-weight: bold;">-6.18%</span><span style="color: #555555;"> (range: -11.46% to -1.49%). The median absolute CV of all features </span><span style="color: #555555; font-weight: bold;">decreased from</span><span style="color: #555555;"> </span><span style="color: #555555; font-weight: bold;">30.56% to 25.86%</span><span style="color: #555555;">.</span></span></span></code></pre></div>
<p>Again, we inspect the data before and after the correction. We
observe that the green trendline follows the samples (in grey). After
the correction, the trend has been fully smoothed out, resulting in a
straight line.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_runscatter.html">plot_runscatter</a></span><span class="op">(</span><span class="va">mexp_drift</span>, variable <span class="op">=</span> <span class="st">"conc_before"</span>, qc_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BQC"</span>, <span class="st">"SPL"</span><span class="op">)</span>,</span>
<span>                rows_page <span class="op">=</span> <span class="fl">1</span>, cols_page <span class="op">=</span> <span class="fl">3</span>, show_trend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Generating plots (1 page)...</span></span></span></code></pre></div>
<p><img src="T_DriftCorrect_files/figure-html/unnamed-chunk-5-1.png" alt="RunScatter plots before and after batch correction
" width="700"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;"> - done!</span></span></span>
<span><span class="fu"><a href="../reference/plot_runscatter.html">plot_runscatter</a></span><span class="op">(</span><span class="va">mexp_drift</span>, variable <span class="op">=</span> <span class="st">"conc"</span>, qc_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BQC"</span>, <span class="st">"SPL"</span><span class="op">)</span>,</span>
<span>                rows_page <span class="op">=</span> <span class="fl">1</span>, cols_page <span class="op">=</span> <span class="fl">3</span>, show_trend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Generating plots (1 page)...</span></span></span></code></pre>
<p><img src="T_DriftCorrect_files/figure-html/unnamed-chunk-5-2.png" alt="RunScatter plots before and after batch correction
" width="700"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;"> - done!</span></span></span></code></pre>
<p>Now, the trends of the study samples appear to be fairly well
corrected. However, in this example, the differences compared to the
previous QC-based smoothing are not very pronounced.</p>
</div>
<div class="section level2">
<h2 id="within-batch-drift-correction">Within-batch drift correction<a class="anchor" aria-label="anchor" href="#within-batch-drift-correction"></a>
</h2>
<p>In the examples before we app;ied drift correction across all
batches. However, if batch-effects are present that break the drifts, it
is recommended to apply drift correction within each batch.</p>
<p>We explore a within-batch drift correction using a sample-based
gaussian kernel smoothing from above in this next example, by setting
<code>batch_wise = TRUE</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mexp_drift</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/correct_drift_gaussiankernel.html">correct_drift_gaussiankernel</a></span><span class="op">(</span></span>
<span>  <span class="va">myexp</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"conc"</span>,</span>
<span>  kernel_size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  batch_wise <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ref_qc_types <span class="op">=</span> <span class="st">"SPL"</span>,</span>
<span>  recalc_trend_after <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="color: #00BB00;">Applying `conc` drift correction...</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #00BB00;">Drift correction was applied to 3 of 3 features (batch-wise).</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="color: #555555;">The median CV change of all features in study samples was </span><span style="color: #555555; font-weight: bold;">-1.20%</span><span style="color: #555555;"> (range: -1.88% to -0.61%). The median absolute CV of all features across batches </span><span style="color: #555555; font-weight: bold;">decreased from</span><span style="color: #555555;"> </span><span style="color: #555555; font-weight: bold;">26.28% to 25.67%</span><span style="color: #555555;">.</span></span></span></code></pre></div>
<p>Now, each batch has its own trendline corresponding the trend in each
batch of each feature. Contrary to the previous correction across
batches, we now observe clear differences in the trends still present
after the correction. This is an effect of the correct applied
independly to each batch, to different sample sizes and present batch
effects. Therefore, it is often necessary to apply batch correction
after bathc-wise drift correction</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_runscatter.html">plot_runscatter</a></span><span class="op">(</span><span class="va">mexp_drift</span>, variable <span class="op">=</span> <span class="st">"conc_before"</span>, qc_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BQC"</span>, <span class="st">"SPL"</span><span class="op">)</span>,</span>
<span>                rows_page <span class="op">=</span> <span class="fl">1</span>, cols_page <span class="op">=</span> <span class="fl">3</span>, show_trend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Generating plots (1 page)...</span></span></span></code></pre></div>
<p><img src="T_DriftCorrect_files/figure-html/unnamed-chunk-7-1.png" alt="RunScatter plots before and after batch correction
" width="700"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;"> - done!</span></span></span>
<span><span class="fu"><a href="../reference/plot_runscatter.html">plot_runscatter</a></span><span class="op">(</span><span class="va">mexp_drift</span>, variable <span class="op">=</span> <span class="st">"conc"</span>, qc_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BQC"</span>, <span class="st">"SPL"</span><span class="op">)</span>,</span>
<span>                rows_page <span class="op">=</span> <span class="fl">1</span>, cols_page <span class="op">=</span> <span class="fl">3</span>, show_trend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Generating plots (1 page)...</span></span></span></code></pre>
<p><img src="T_DriftCorrect_files/figure-html/unnamed-chunk-7-2.png" alt="RunScatter plots before and after batch correction
" width="700"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;"> - done!</span></span></span></code></pre>
<p>We therefore apply a subsequent batch correction using
median-centering, resulting in an alignment of the batches.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mexp_drift</span> <span class="op">&lt;-</span> <span class="fu">midar</span><span class="fu">::</span><span class="fu"><a href="../reference/correct_batch_centering.html">correct_batch_centering</a></span><span class="op">(</span></span>
<span>  <span class="va">mexp_drift</span>, </span>
<span>  ref_qc_types <span class="op">=</span> <span class="st">"SPL"</span>, </span>
<span>  variable <span class="op">=</span> <span class="st">"conc"</span>,</span>
<span>  correct_scale <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="color: #BBBB00;">Adding batch correction on top of `conc` drift-correction.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #00BB00;">Batch median-centering of 6 batches was applied to drift-corrected concentrations of all 3 features.</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> <span style="color: #555555;">The median CV change of all features in study samples was </span><span style="color: #555555; font-weight: bold;">-5.38%</span><span style="color: #555555;"> (range: -8.80% to -0.60%).  The median absolute CV of all features </span><span style="color: #555555; font-weight: bold;">decreased from</span><span style="color: #555555;"> </span><span style="color: #555555; font-weight: bold;">30.00% to 25.68%</span><span style="color: #555555;">.</span></span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_runscatter.html">plot_runscatter</a></span><span class="op">(</span><span class="va">mexp_drift</span>, variable <span class="op">=</span> <span class="st">"conc"</span>, qc_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BQC"</span>, <span class="st">"SPL"</span><span class="op">)</span>,</span>
<span>                rows_page <span class="op">=</span> <span class="fl">1</span>, cols_page <span class="op">=</span> <span class="fl">3</span>, show_trend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Generating plots (1 page)...</span></span></span></code></pre></div>
<p><img src="T_DriftCorrect_files/figure-html/unnamed-chunk-8-1.png" alt="RunScatter plots before and after batch correction
" width="700"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;"> - done!</span></span></span></code></pre>
</div>
<div class="section level2">
<h2 id="export-corrected-data">Export corrected data<a class="anchor" aria-label="anchor" href="#export-corrected-data"></a>
</h2>
<p>Next, we can either continue to work with the corrected data using
<code>MiDAR</code> functions or export the data.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/save_dataset_csv.html">save_dataset_csv</a></span><span class="op">(</span></span>
<span>  <span class="va">mexp_drift</span>, </span>
<span>  path <span class="op">=</span> <span class="st">"drift-batch-corrected-conc-data.csv"</span>, </span>
<span>  variable <span class="op">=</span> <span class="st">"conc"</span>, </span>
<span>  filter_data <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #00BB00;">Concentration values for 498 analyses and 3 features have been exported to 'drift-batch-corrected-conc-data.csv'.</span></span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bo Burla.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
