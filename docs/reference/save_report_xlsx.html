<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Write Data Processing Report (EXCEL) — save_report_xlsx • midar</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Write Data Processing Report (EXCEL) — save_report_xlsx"><meta name="description" content="Generates a data processing report from a MidarExperiment object and writes it to an Excel file.
The report includes information on the data processing steps, quality control metrics, feature concentrations, and metadata.
Following tables will be created as sheets in the EXCEL file:"><meta property="og:description" content="Generates a data processing report from a MidarExperiment object and writes it to an Excel file.
The report includes information on the data processing steps, quality control metrics, feature concentrations, and metadata.
Following tables will be created as sheets in the EXCEL file:"><meta property="og:image" content="https://slinghub.github.io/midar/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">midar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/00_get_started.html">Getting started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials-recipes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials &amp; Recipes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials-recipes"><li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/T01_prepdata.html">Preparing and importing data</a></li>
    <li><a class="dropdown-item" href="../articles/T02_settingup_workflow.html">Setting Up a Basic MiDAR Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/T01_targetlipidomics_workflow.html">Targeted lipidomics with QC</a></li>
    <li><a class="dropdown-item" href="../articles/T_DriftCorrect.html">Drift Correction</a></li>
    <li><a class="dropdown-item" href="../articles/T_BatchCorrect.html">Batch Correction</a></li>
    <li><a class="dropdown-item" href="../articles/T_CalibRef.html">Calibration by a Reference Sample</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Recipes</h6></li>
    <li><a class="dropdown-item" href="../articles/R01_quantms.html">External Calibration and QC</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-manual" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Manual</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-manual"><li><h6 class="dropdown-header" data-toc-skip>Key Concepts</h6></li>
    <li><a class="dropdown-item" href="../articles/01_datastructure.html">Data Structures</a></li>
    <li><a class="dropdown-item" href="../articles/02_keydataids.html">Data Indentifier</a></li>
    <li><a class="dropdown-item" href="../articles/02b_keyfeaturevar.html">Feature Variables</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Data and Metadata</h6></li>
    <li><a class="dropdown-item" href="../articles/03_midarexperiment.html">MidarExperiment Object</a></li>
    <li><a class="dropdown-item" href="../articles/04_dataimport.html">Data Import</a></li>
    <li><a class="dropdown-item" href="../articles/05_metadataimport.html">Metadata Import</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/07_driftbatchcorr.html">Batch/Drift Correction</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SLINGhub/midar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Write Data Processing Report (EXCEL)</h1>
      <small class="dont-index">Source: <a href="https://github.com/SLINGhub/midar/blob/HEAD/R/data-export.R" class="external-link"><code>R/data-export.R</code></a></small>
      <div class="d-none name"><code>save_report_xlsx.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generates a data processing report from a <code>MidarExperiment</code> object and writes it to an Excel file.
The report includes information on the data processing steps, quality control metrics, feature concentrations, and metadata.
Following tables will be created as sheets in the EXCEL file:</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">save_report_xlsx</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">path</span>,</span>
<span>  filtered_variable <span class="op">=</span> <span class="st">"conc"</span>,</span>
<span>  normalized_variable <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A <code>MidarExperiment</code> object containing original and processed data and metadata.</p></dd>


<dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>A character string specifying the file name and path for the Excel file.
If the path does not include an <code>.xlsx</code> extension, it is added automatically.</p></dd>


<dt id="arg-filtered-variable">filtered_variable<a class="anchor" aria-label="anchor" href="#arg-filtered-variable"></a></dt>
<dd><p>A character string specifying the variable name in the
filtered data to be exported. It must be one of "conc", "intensity", "norm_intensity",
"response", "area", "height", "conc_raw", "rt", or "fwhm". The defined variable
name will be included in the sheet name. Default is "conc".</p></dd>


<dt id="arg-normalized-variable">normalized_variable<a class="anchor" aria-label="anchor" href="#arg-normalized-variable"></a></dt>
<dd><p>A character string indicating if and which normalized feature values  (by reference sample) to include in the report.See also <code>[calibrate_by_reference()]</code>.</p></dd>


<dt id="arg-overwrite">overwrite<a class="anchor" aria-label="anchor" href="#arg-overwrite"></a></dt>
<dd><p>A logical value indicating whether to overwrite the file if it already exists. Default is <code>TRUE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The function does not return a value. It writes the report to the specified Excel file.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<ul><li><p>Info: General  information including date, author, and MiDAR version, processing status and feature concentration unit.</p></li>
<li><p>Feature_QC_metrics: Quality control metrics of all features.</p></li>
<li><p>QCfilt_x_StudySamples: Feature (QC)-filtered data (variable defiend via <code>filtered_variable</code>) in study samples ('SPL'). Filter have to be set via <code><a href="filter_features_qc.html">filter_features_qc()</a></code>. The <em>x</em> corresponds to the <code>filtered_variable</code> argument.</p></li>
<li><p>QCfilt_x_AllSamples: Feature (QC)-filtered data (variable defiend via <code>filtered_variable</code>) in all samples. Filter have to be set via <code><a href="filter_features_qc.html">filter_features_qc()</a></code>. The <em>x</em> corresponds to the <code>filtered_variable</code> argument.</p></li>
<li><p>Conc_FullDataset: Final feature concentrations from the full, non-filtered dataset.</p></li>
<li><p>Raw_Intensity_FullDataset: Raw feature intensities from the full, non-filtered dataset.</p></li>
<li><p>Norm_Intensity_FullDataset: Normalized feature intensities from the full, non-filtered dataset.</p></li>
<li><p>SampleMetadata:  Analysis metadata that was imported and used for processing steps</p></li>
<li><p>FeatureMetadata: Feature metadata that was imported and used for processing steps</p></li>
<li><p>InternalStandards: Internal standards metadata with concentrations</p></li>
<li><p>BatchInfo: Information on batches and positions of first and last analysis/sample
in each batch</p></li>
</ul><p>#' If certain data sets are not available, the function includes empty tables for the corresponding dataset.</p>
<p>Concentration corresponds to the final concentration values after applying isotope correction, and drift and batch correction, if applicable.
If any corrections, such as drift or batch correction, were applied to raw or normalized intensities, the exported values will reflect these corrections.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="normalize_by_istd.html">normalize_by_istd()</a></code>, <code><a href="quantify_by_istd.html">quantify_by_istd()</a></code>, <code><a href="quantify_by_calibration.html">quantify_by_calibration()</a></code>, <code><a href="calibrate_by_reference.html">calibrate_by_reference()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Assuming `midarexp` is a MidarExperiment object and `output_path` is a valid path</span></span></span>
<span class="r-in"><span><span class="fu">save_report_xlsx</span><span class="op">(</span>data <span class="op">=</span> <span class="va">midarexp</span>, path <span class="op">=</span> <span class="st">"output_path/report.xlsx"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bo Burla.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

