<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create a Run Scatter Plot to Visualize Analyte Distributions — plot_runscatter • midar</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create a Run Scatter Plot to Visualize Analyte Distributions — plot_runscatter"><meta name="description" content="The run scatter plot allows you to visualize the sequence of measurements and distribution of QC (sample) types across the analysis run sequence.
This can be useful for identifying trends, outliers, or other patterns in the data.
The function provides a range of options for customizing the plot, such as:
Filtering the data (e.g., by QC type, feature ID)
Applying outlier capping
Displaying batch information and control limits
Showing trend lines for drift correction
Controlling the layout and appearance of the plot

"><meta property="og:description" content="The run scatter plot allows you to visualize the sequence of measurements and distribution of QC (sample) types across the analysis run sequence.
This can be useful for identifying trends, outliers, or other patterns in the data.
The function provides a range of options for customizing the plot, such as:
Filtering the data (e.g., by QC type, feature ID)
Applying outlier capping
Displaying batch information and control limits
Showing trend lines for drift correction
Controlling the layout and appearance of the plot

"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">midar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/getstarted.html">Get Started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Key Concepts</h6></li>
    <li><a class="dropdown-item" href="../articles/datastructure.html">Data Structures</a></li>
    <li><a class="dropdown-item" href="../articles/midarexperiment.html">MidarExperiment</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Data and Metadata</h6></li>
    <li><a class="dropdown-item" href="../articles/dataimport.html">Importing</a></li>
    <li><a class="dropdown-item" href="../articles/annotating.html">Annotating (Metadata)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/BatchDriftCorrect.html">Batch/Drift Correction</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/updates.html">Updates</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SLINGhub/midar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create a Run Scatter Plot to Visualize Analyte Distributions</h1>
      <small class="dont-index">Source: <a href="https://github.com/SLINGhub/midar/blob/HEAD/R/plots-qc-runorder.R" class="external-link"><code>R/plots-qc-runorder.R</code></a></small>
      <div class="d-none name"><code>plot_runscatter.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The run scatter plot allows you to visualize the sequence of measurements and distribution of QC (sample) types across the analysis run sequence.
This can be useful for identifying trends, outliers, or other patterns in the data.</p>
<p>The function provides a range of options for customizing the plot, such as:</p><ul><li><p>Filtering the data (e.g., by QC type, feature ID)</p></li>
<li><p>Applying outlier capping</p></li>
<li><p>Displaying batch information and control limits</p></li>
<li><p>Showing trend lines for drift correction</p></li>
<li><p>Controlling the layout and appearance of the plot</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_runscatter</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"intensity"</span>, <span class="st">"norm_intensity"</span>, <span class="st">"conc"</span>, <span class="st">"conc_raw"</span>, <span class="st">"area"</span>, <span class="st">"height"</span>,</span>
<span>    <span class="st">"fwhm"</span><span class="op">)</span>,</span>
<span>  filter_data <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  qc_types <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  include_qualifier <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  include_feature_filter <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  exclude_feature_filter <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  plot_range_indices <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  output_pdf <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  path <span class="op">=</span> <span class="st">""</span>,</span>
<span>  log_scale <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cap_outliers <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cap_qc_k_mad <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  cap_spl_k_mad <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  cap_top_n_values <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  show_batches <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show_control_limits <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  set_limits_n_sd <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  limits_batchwise <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  limits_linecolor <span class="op">=</span> <span class="st">"#38dff5"</span>,</span>
<span>  limits_linewidth <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  batches_as_shades <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  batch_line_color <span class="op">=</span> <span class="st">"#b6f0c5"</span>,</span>
<span>  batch_shading_color <span class="op">=</span> <span class="st">"grey93"</span>,</span>
<span>  cols_page <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  rows_page <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  base_font_size <span class="op">=</span> <span class="fl">11</span>,</span>
<span>  annot_scale <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  show_trend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  trend_linecolor <span class="op">=</span> <span class="st">"#22e06b"</span>,</span>
<span>  fit_qc_type <span class="op">=</span> <span class="st">"BQC"</span>,</span>
<span>  page_orientation <span class="op">=</span> <span class="st">"LANDSCAPE"</span>,</span>
<span>  point_transparency <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  point_size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  point_border_width <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  specific_page <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  y_label_text <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  return_plots <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show_gridlines <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show_progress <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>MidarExperiment object</p></dd>


<dt id="arg-variable">variable<a class="anchor" aria-label="anchor" href="#arg-variable"></a></dt>
<dd><p>Variable to plot, one of 'area', 'height', 'intensity', 'norm_intensity', 'intensity_raw', 'norm_intensity_raw', 'response', 'conc', 'conc_raw', 'rt', 'fwhm.'</p></dd>


<dt id="arg-filter-data">filter_data<a class="anchor" aria-label="anchor" href="#arg-filter-data"></a></dt>
<dd><p>Logical, whether to use QC-filtered data based on criteria set via <code><a href="filter_features_qc.html">filter_features_qc()</a></code></p></dd>


<dt id="arg-qc-types">qc_types<a class="anchor" aria-label="anchor" href="#arg-qc-types"></a></dt>
<dd><p>QC types to be shown. Can be a vector of QC types or a regular expression pattern. <code>NA</code> (default) displays all available QC/Sample types.</p></dd>


<dt id="arg-include-qualifier">include_qualifier<a class="anchor" aria-label="anchor" href="#arg-include-qualifier"></a></dt>
<dd><p>Logical, whether to include qualifier features</p></dd>


<dt id="arg-include-feature-filter">include_feature_filter<a class="anchor" aria-label="anchor" href="#arg-include-feature-filter"></a></dt>
<dd><p>Regex pattern to select features by feature_id. <code>NA</code> or <code>""</code> ignores the filter.</p></dd>


<dt id="arg-exclude-feature-filter">exclude_feature_filter<a class="anchor" aria-label="anchor" href="#arg-exclude-feature-filter"></a></dt>
<dd><p>Regex pattern to exclude features by feature_id. <code>NA</code> or <code>""</code> ignores the filter.</p></dd>


<dt id="arg-plot-range-indices">plot_range_indices<a class="anchor" aria-label="anchor" href="#arg-plot-range-indices"></a></dt>
<dd><p>Numeric vector of length 2, specifying the start and end indices of the sequence to be plotted. <code>NA</code> plots all samples.</p></dd>


<dt id="arg-output-pdf">output_pdf<a class="anchor" aria-label="anchor" href="#arg-output-pdf"></a></dt>
<dd><p>Logical, whether to save the plot as a PDF file</p></dd>


<dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>File name for the PDF output</p></dd>


<dt id="arg-log-scale">log_scale<a class="anchor" aria-label="anchor" href="#arg-log-scale"></a></dt>
<dd><p>Logical, whether to use a log10 scale for the y-axis</p></dd>


<dt id="arg-cap-outliers">cap_outliers<a class="anchor" aria-label="anchor" href="#arg-cap-outliers"></a></dt>
<dd><p>Logical, whether to cap upper outliers based on MAD fences of SPL and QC samples</p></dd>


<dt id="arg-cap-qc-k-mad">cap_qc_k_mad<a class="anchor" aria-label="anchor" href="#arg-cap-qc-k-mad"></a></dt>
<dd><p>Numeric, k * MAD (median absolute deviation) for outlier capping of QC samples</p></dd>


<dt id="arg-cap-spl-k-mad">cap_spl_k_mad<a class="anchor" aria-label="anchor" href="#arg-cap-spl-k-mad"></a></dt>
<dd><p>Numeric, k * MAD (median absolute deviation) for outlier capping of SPL samples</p></dd>


<dt id="arg-cap-top-n-values">cap_top_n_values<a class="anchor" aria-label="anchor" href="#arg-cap-top-n-values"></a></dt>
<dd><p>Numeric, cap the top n values regardless of MAD fences. <code>NA</code> or <code>0</code> ignores this filter.</p></dd>


<dt id="arg-show-batches">show_batches<a class="anchor" aria-label="anchor" href="#arg-show-batches"></a></dt>
<dd><p>Logical, whether to show batch separators in the plot</p></dd>


<dt id="arg-show-control-limits">show_control_limits<a class="anchor" aria-label="anchor" href="#arg-show-control-limits"></a></dt>
<dd><p>Logical, whether to show the mean line for the specified QC types. <code>NA</code> ignores the mean line.</p></dd>


<dt id="arg-set-limits-n-sd">set_limits_n_sd<a class="anchor" aria-label="anchor" href="#arg-set-limits-n-sd"></a></dt>
<dd><p>Numeric, show +/- n x SD lines for the QC types defined in <code>show_control_limits</code>. <code>NA</code> ignores the SD lines.</p></dd>


<dt id="arg-limits-batchwise">limits_batchwise<a class="anchor" aria-label="anchor" href="#arg-limits-batchwise"></a></dt>
<dd><p>Logical, whether to calculate the mean and SD lines per batch</p></dd>


<dt id="arg-limits-linecolor">limits_linecolor<a class="anchor" aria-label="anchor" href="#arg-limits-linecolor"></a></dt>
<dd><p>Color of the mean and SD lines</p></dd>


<dt id="arg-limits-linewidth">limits_linewidth<a class="anchor" aria-label="anchor" href="#arg-limits-linewidth"></a></dt>
<dd><p>Width of the mean and SD lines</p></dd>


<dt id="arg-batches-as-shades">batches_as_shades<a class="anchor" aria-label="anchor" href="#arg-batches-as-shades"></a></dt>
<dd><p>Logical, whether to show batches as shaded areas instead of line separators</p></dd>


<dt id="arg-batch-line-color">batch_line_color<a class="anchor" aria-label="anchor" href="#arg-batch-line-color"></a></dt>
<dd><p>Color of the batch separator lines</p></dd>


<dt id="arg-batch-shading-color">batch_shading_color<a class="anchor" aria-label="anchor" href="#arg-batch-shading-color"></a></dt>
<dd><p>Color of the batch shaded areas</p></dd>


<dt id="arg-cols-page">cols_page<a class="anchor" aria-label="anchor" href="#arg-cols-page"></a></dt>
<dd><p>Number of columns per page</p></dd>


<dt id="arg-rows-page">rows_page<a class="anchor" aria-label="anchor" href="#arg-rows-page"></a></dt>
<dd><p>Number of rows per page</p></dd>


<dt id="arg-base-font-size">base_font_size<a class="anchor" aria-label="anchor" href="#arg-base-font-size"></a></dt>
<dd><p>Base font size for the plot</p></dd>


<dt id="arg-annot-scale">annot_scale<a class="anchor" aria-label="anchor" href="#arg-annot-scale"></a></dt>
<dd><p>Scale factor for text elements</p></dd>


<dt id="arg-show-trend">show_trend<a class="anchor" aria-label="anchor" href="#arg-show-trend"></a></dt>
<dd><p>Logical, whether to show a drift correction trend line</p></dd>


<dt id="arg-trend-linecolor">trend_linecolor<a class="anchor" aria-label="anchor" href="#arg-trend-linecolor"></a></dt>
<dd><p>Color of the trend line</p></dd>


<dt id="arg-fit-qc-type">fit_qc_type<a class="anchor" aria-label="anchor" href="#arg-fit-qc-type"></a></dt>
<dd><p>QC type used for smoothing the trend line</p></dd>


<dt id="arg-page-orientation">page_orientation<a class="anchor" aria-label="anchor" href="#arg-page-orientation"></a></dt>
<dd><p>Page orientation, "LANDSCAPE" or "PORTRAIT"</p></dd>


<dt id="arg-point-transparency">point_transparency<a class="anchor" aria-label="anchor" href="#arg-point-transparency"></a></dt>
<dd><p>Alpha transparency of the data points</p></dd>


<dt id="arg-point-size">point_size<a class="anchor" aria-label="anchor" href="#arg-point-size"></a></dt>
<dd><p>Size of the data points</p></dd>


<dt id="arg-point-border-width">point_border_width<a class="anchor" aria-label="anchor" href="#arg-point-border-width"></a></dt>
<dd><p>Width of the data point borders</p></dd>


<dt id="arg-specific-page">specific_page<a class="anchor" aria-label="anchor" href="#arg-specific-page"></a></dt>
<dd><p>Integer, show/save a specific page number. <code>NA</code> plots/saves all pages.</p></dd>


<dt id="arg-y-label-text">y_label_text<a class="anchor" aria-label="anchor" href="#arg-y-label-text"></a></dt>
<dd><p>Override the default y-axis label text</p></dd>


<dt id="arg-return-plots">return_plots<a class="anchor" aria-label="anchor" href="#arg-return-plots"></a></dt>
<dd><p>Logical, whether to return the list of ggplot objects</p></dd>


<dt id="arg-show-gridlines">show_gridlines<a class="anchor" aria-label="anchor" href="#arg-show-gridlines"></a></dt>
<dd><p>Logical, whether to show major x and y gridlines</p></dd>


<dt id="arg-show-progress">show_progress<a class="anchor" aria-label="anchor" href="#arg-show-progress"></a></dt>
<dd><p>Logical, whether to show a progress bar</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of ggplot2 plots, or <code>NULL</code> if <code>return_plots = FALSE</code></p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bo Burla.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

