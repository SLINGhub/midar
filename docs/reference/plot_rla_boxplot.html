<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Relative Log Abundance (RLA) Plot — plot_rla_boxplot • midar</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Relative Log Abundance (RLA) Plot — plot_rla_boxplot"><meta name="description" content="The Relative Log Abundance (RLA) plot visualizes standardized
feature abundances distributions across samples. RLA standardization involves
subtracting either the within-batch or across-batch median from each
feature's log-transformed abundance. Thse plots are effective for
identifying systematic technical variations, such as batch effects,
instrument drift, or sample handling inconsistencies, by providing a
robust representation less susceptible to global intensity shifts.
The function also incorporates optional outlier detection and
visualization functionalities to identify anomalous samples based on
their median RLA values.
This funcion returns a list with the ggplot  object representing the RLA plot and a table with detected outliers (if outlier_detection = TRUE)."><meta property="og:description" content="The Relative Log Abundance (RLA) plot visualizes standardized
feature abundances distributions across samples. RLA standardization involves
subtracting either the within-batch or across-batch median from each
feature's log-transformed abundance. Thse plots are effective for
identifying systematic technical variations, such as batch effects,
instrument drift, or sample handling inconsistencies, by providing a
robust representation less susceptible to global intensity shifts.
The function also incorporates optional outlier detection and
visualization functionalities to identify anomalous samples based on
their median RLA values.
This funcion returns a list with the ggplot  object representing the RLA plot and a table with detected outliers (if outlier_detection = TRUE)."><meta property="og:image" content="https://slinghub.github.io/midar/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">midar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/00_get_started.html">Getting started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials-recipes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials &amp; Recipes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials-recipes"><li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/T01_targetlipidomics_workflow.html">Lipidomics data processing (full workflow)</a></li>
    <li><a class="dropdown-item" href="../articles/T01_prepdata.html">Preparing and importing data</a></li>
    <li><a class="dropdown-item" href="../articles/T02_settingup_workflow.html">Basic MiDAR workflow</a></li>
    <li><a class="dropdown-item" href="../articles/T_DriftCorrect.html">Drift correction</a></li>
    <li><a class="dropdown-item" href="../articles/T_BatchCorrect.html">Batch correction</a></li>
    <li><a class="dropdown-item" href="../articles/T_CalibRef.html">Calibration by a reference sample</a></li>
    <li><a class="dropdown-item" href="../articles/R01_quantms.html">External calibration and QC</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Recipes</h6></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-manual" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Manual</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-manual"><li><h6 class="dropdown-header" data-toc-skip>Key concepts</h6></li>
    <li><a class="dropdown-item" href="../articles/01_datastructure.html">Data structures</a></li>
    <li><a class="dropdown-item" href="../articles/02_keydataids.html">Data indentifier</a></li>
    <li><a class="dropdown-item" href="../articles/02b_keyfeaturevar.html">Feature variables</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Data and metadata</h6></li>
    <li><a class="dropdown-item" href="../articles/03_midarexperiment.html">MidarExperiment Object</a></li>
    <li><a class="dropdown-item" href="../articles/04_dataimport.html">Data import</a></li>
    <li><a class="dropdown-item" href="../articles/05_metadataimport.html">Metadata import</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/07_driftbatchcorr.html">Batch/drift correction</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SLINGhub/midar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Relative Log Abundance (RLA) Plot</h1>
      <small class="dont-index">Source: <a href="https://github.com/SLINGhub/midar/blob/HEAD/R/plots-qc-runorder.R" class="external-link"><code>R/plots-qc-runorder.R</code></a></small>
      <div class="d-none name"><code>plot_rla_boxplot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The Relative Log Abundance (RLA) plot visualizes standardized
feature abundances distributions across samples. RLA standardization involves
subtracting either the within-batch or across-batch median from each
feature's log-transformed abundance. Thse plots are effective for
identifying systematic technical variations, such as batch effects,
instrument drift, or sample handling inconsistencies, by providing a
robust representation less susceptible to global intensity shifts.</p>
<p>The function also incorporates optional outlier detection and
visualization functionalities to identify anomalous samples based on
their median RLA values.</p>
<p>This funcion returns a list with the ggplot  object representing the RLA plot and a table with detected outliers (if <code>outlier_detection = TRUE</code>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_rla_boxplot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">rla_type_batch</span>,</span>
<span>  <span class="va">variable</span>,</span>
<span>  qc_types <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  plot_range <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  rla_limit_to_range <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  remove_gaps <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  filter_data <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  include_qualifier <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  include_istd <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  include_feature_filter <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  exclude_feature_filter <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  show_timestamp <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  min_feature_intensity <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  y_lim <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  outlier_detection <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  outlier_exclude <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  outlier_method <span class="op">=</span> <span class="st">"mad"</span>,</span>
<span>  outlier_qctypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SPL"</span>, <span class="st">"TQC"</span>, <span class="st">"BQC"</span>, <span class="st">"LTR"</span>, <span class="st">"NIST"</span><span class="op">)</span>,</span>
<span>  outlier_k <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  show_batches <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  batch_zebra_stripe <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  batch_line_color <span class="op">=</span> <span class="st">"#b6f0c5"</span>,</span>
<span>  batch_fill_color <span class="op">=</span> <span class="st">"grey93"</span>,</span>
<span>  x_gridlines <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  linewidth <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  base_font_size <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  relative_log_abundances <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show_plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>MidarExperiment</p></dd>


<dt id="arg-rla-type-batch">rla_type_batch<a class="anchor" aria-label="anchor" href="#arg-rla-type-batch"></a></dt>
<dd><p>Character, must be either "within" or "across", defining whether to use within-batch or across-batch RLA</p></dd>


<dt id="arg-variable">variable<a class="anchor" aria-label="anchor" href="#arg-variable"></a></dt>
<dd><p>Variable to plot, must be one of "intensity", "norm_intensity", "conc", "area", "height", "fwhm", or one of
"intensity_raw", "intensity_before", "norm_intensity_raw", "norm_intensity_before", "conc_raw", "conc_before"</p></dd>


<dt id="arg-qc-types">qc_types<a class="anchor" aria-label="anchor" href="#arg-qc-types"></a></dt>
<dd><p>QC types to be plotted. Can be a vector of QC types or a regular expression pattern. <code>NA</code> (default) displays all available QC/Sample types.</p></dd>


<dt id="arg-plot-range">plot_range<a class="anchor" aria-label="anchor" href="#arg-plot-range"></a></dt>
<dd><p>Numeric vector of length 2, specifying the start and end indices of the analysis order to be plotted. <code>NA</code> plots all samples.</p></dd>


<dt id="arg-rla-limit-to-range">rla_limit_to_range<a class="anchor" aria-label="anchor" href="#arg-rla-limit-to-range"></a></dt>
<dd><p>Logical, whether to limit the RLA values to the specified <code>plot_range</code>. Default is <code>FALSE</code>, which means RLA values are calculated for all samples.</p></dd>


<dt id="arg-remove-gaps">remove_gaps<a class="anchor" aria-label="anchor" href="#arg-remove-gaps"></a></dt>
<dd><p>Logical, whether to remove gaps in the x-axis, occuring from QC types that were not selected. Default is <code>TRUE</code>.
is supplied, only features with exactly these names are excluded (applied individually as OR conditions).</p></dd>


<dt id="arg-filter-data">filter_data<a class="anchor" aria-label="anchor" href="#arg-filter-data"></a></dt>
<dd><p>Logical, whether to use QC-filtered data based on criteria set via <code><a href="filter_features_qc.html">filter_features_qc()</a></code>.</p></dd>


<dt id="arg-include-qualifier">include_qualifier<a class="anchor" aria-label="anchor" href="#arg-include-qualifier"></a></dt>
<dd><p>Logical, whether to include qualifier features. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-include-istd">include_istd<a class="anchor" aria-label="anchor" href="#arg-include-istd"></a></dt>
<dd><p>Logical, whether to include internal standard (ISTD) features. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-include-feature-filter">include_feature_filter<a class="anchor" aria-label="anchor" href="#arg-include-feature-filter"></a></dt>
<dd><p>A regex pattern or a vector of feature names used to filter features by <code>feature_id</code>.
If <code>NA</code> or an empty string (<code>""</code>) is provided, the filter is ignored. When a vector of length &gt; 1 is supplied,
is supplied, only features with exactly these names are selected (applied individually as OR conditions).</p></dd>


<dt id="arg-exclude-feature-filter">exclude_feature_filter<a class="anchor" aria-label="anchor" href="#arg-exclude-feature-filter"></a></dt>
<dd><p>A regex pattern or a vector of feature names to exclude features by feature_id.
If <code>NA</code> or an empty string (<code>""</code>) is provided, the filter is ignored. When a vector of length &gt; 1 is supplied.</p></dd>


<dt id="arg-show-timestamp">show_timestamp<a class="anchor" aria-label="anchor" href="#arg-show-timestamp"></a></dt>
<dd><p>Logical, whether to use the acquisition timestamp as
the x-axis instead of the run sequence number</p></dd>


<dt id="arg-min-feature-intensity">min_feature_intensity<a class="anchor" aria-label="anchor" href="#arg-min-feature-intensity"></a></dt>
<dd><p>Numeric, exclude features with overall median signal below this value</p></dd>


<dt id="arg-y-lim">y_lim<a class="anchor" aria-label="anchor" href="#arg-y-lim"></a></dt>
<dd><p>Numeric vector of length 2, specifying the lower and upper y-axis limits. Default is <code>NA</code>, which uses limits calculated based on <code>outlier_exclude</code>.</p></dd>


<dt id="arg-outlier-detection">outlier_detection<a class="anchor" aria-label="anchor" href="#arg-outlier-detection"></a></dt>
<dd><p>Logical, whether to show outlier fences on the plot and return a table with detect outliers based on the method defined by <code>outlier_method</code>.</p></dd>


<dt id="arg-outlier-exclude">outlier_exclude<a class="anchor" aria-label="anchor" href="#arg-outlier-exclude"></a></dt>
<dd><p>Logical, whether to exclude outlier values from the plot. Default is <code>FALSE</code>, which means outliers are shown.</p></dd>


<dt id="arg-outlier-method">outlier_method<a class="anchor" aria-label="anchor" href="#arg-outlier-method"></a></dt>
<dd><p>Character, method used for outlier detection. Default is "mad" (median absolute deviation).
Other possible values are "iqr", "sd", "z_normal", "z_robust", "quantile", and "fold". See get_outlier_bounds() for details.</p></dd>


<dt id="arg-outlier-qctypes">outlier_qctypes<a class="anchor" aria-label="anchor" href="#arg-outlier-qctypes"></a></dt>
<dd><p>Character vector, QC types to use for outlier detection. Default is <code>c("SPL", "TQC", "BQC")</code>.</p></dd>


<dt id="arg-outlier-k">outlier_k<a class="anchor" aria-label="anchor" href="#arg-outlier-k"></a></dt>
<dd><p>Numeric, multiplier for the outlier detection method. Default is <code>NULL</code>, which uses the default value for the selected method.
See get_outlier_bounds() for details. When using the "fold" method, either single numeric value or a vector with two values (lower and upper fences) can be supplied.</p></dd>


<dt id="arg-show-batches">show_batches<a class="anchor" aria-label="anchor" href="#arg-show-batches"></a></dt>
<dd><p>Logical, whether to show batch separators in the plot</p></dd>


<dt id="arg-batch-zebra-stripe">batch_zebra_stripe<a class="anchor" aria-label="anchor" href="#arg-batch-zebra-stripe"></a></dt>
<dd><p>Logical, whether to show batches as shaded areas instead of line separators</p></dd>


<dt id="arg-batch-line-color">batch_line_color<a class="anchor" aria-label="anchor" href="#arg-batch-line-color"></a></dt>
<dd><p>Character, color of the batch separator lines</p></dd>


<dt id="arg-batch-fill-color">batch_fill_color<a class="anchor" aria-label="anchor" href="#arg-batch-fill-color"></a></dt>
<dd><p>Character, color of the batch shaded areas</p></dd>


<dt id="arg-x-gridlines">x_gridlines<a class="anchor" aria-label="anchor" href="#arg-x-gridlines"></a></dt>
<dd><p>Logical, whether to show major x-axis gridlines</p></dd>


<dt id="arg-linewidth">linewidth<a class="anchor" aria-label="anchor" href="#arg-linewidth"></a></dt>
<dd><p>Numeric, line width used for whiskers of the boxplot</p></dd>


<dt id="arg-base-font-size">base_font_size<a class="anchor" aria-label="anchor" href="#arg-base-font-size"></a></dt>
<dd><p>Numeric, base font size for the plot</p></dd>


<dt id="arg-relative-log-abundances">relative_log_abundances<a class="anchor" aria-label="anchor" href="#arg-relative-log-abundances"></a></dt>
<dd><p>Logical, whether to use relative log abundances (RLA) or just log-transformed values</p></dd>


<dt id="arg-show-plot">show_plot<a class="anchor" aria-label="anchor" href="#arg-show-plot"></a></dt>
<dd><p>Logical, whether to display the plot. Default is <code>TRUE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with the ggplot object representing the RLA plot and a table with detected outliers if <code>outlier_detection = TRUE</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>De Livera et al. (2012) Normalizing and integrating metabolomics data. Analytical Chemistry 10768-10776
<a href="https://doi.org/10.1021/ac302748b" class="external-link">DOI: 10.1021/ac302748b</a>
De Livera et al. (2015) Statistical Methods for Handling Unwanted Variation in Metabolomics Data. Analytical Chemistry 87(7):3606-3615
<a href="https://doi.org/10.1021/ac502439y" class="external-link">DOI: 10.1021/ac502439y</a></p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bo Burla.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

