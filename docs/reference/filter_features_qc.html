<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Feature Filtering Based on Quality Control Criteria — filter_features_qc • midar</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Feature Filtering Based on Quality Control Criteria — filter_features_qc"><meta name="description" content="Filters a dataset based on quality control (QC) criteria, including intensity,
coefficient of variation (CV), signal-to-blank ratios, D-ratio, response curve properties,
and proportion of missing values. Criteria apply to different QC types (BQC, TQC) and
measurement variables (concentration, intensity, and normalized intensity)."><meta property="og:description" content="Filters a dataset based on quality control (QC) criteria, including intensity,
coefficient of variation (CV), signal-to-blank ratios, D-ratio, response curve properties,
and proportion of missing values. Criteria apply to different QC types (BQC, TQC) and
measurement variables (concentration, intensity, and normalized intensity)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">midar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/getstarted.html">Get Started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Key Concepts</h6></li>
    <li><a class="dropdown-item" href="../articles/datastructure.html">Data Structures</a></li>
    <li><a class="dropdown-item" href="../articles/midarexperiment.html">MidarExperiment</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Data and Metadata</h6></li>
    <li><a class="dropdown-item" href="../articles/dataimport.html">Importing</a></li>
    <li><a class="dropdown-item" href="../articles/annotating.html">Annotating (Metadata)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/BatchDriftCorrect.html">Batch/Drift Correction</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/updates.html">Updates</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SLINGhub/midar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Feature Filtering Based on Quality Control Criteria</h1>
      <small class="dont-index">Source: <a href="https://github.com/SLINGhub/midar/blob/HEAD/R/qc-filtering.R" class="external-link"><code>R/qc-filtering.R</code></a></small>
      <div class="d-none name"><code>filter_features_qc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Filters a dataset based on quality control (QC) criteria, including intensity,
coefficient of variation (CV), signal-to-blank ratios, D-ratio, response curve properties,
and proportion of missing values. Criteria apply to different QC types (BQC, TQC) and
measurement variables (concentration, intensity, and normalized intensity).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">filter_features_qc</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  replace_existing <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  batch_medians <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  qualifier.include <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  istd.include <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  features.to.keep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max.prop.missing.intensity.spl <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  max.prop.missing.normintensity.spl <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  max.prop.missing.conc.spl <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  min.intensity.lowest.bqc <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  min.intensity.lowest.tqc <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  min.intensity.lowest.spl <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  min.intensity.median.bqc <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  min.intensity.median.tqc <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  min.intensity.median.spl <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  min.intensity.highest.spl <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  min.signalblank.median.spl.pblk <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  min.signalblank.median.spl.ublk <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  min.signalblank.median.spl.sblk <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  max.cv.intensity.bqc <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  max.cv.intensity.tqc <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  max.cv.normintensity.bqc <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  max.cv.normintensity.tqc <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  max.cv.conc.bqc <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  max.cv.conc.tqc <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  response.curves.select <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  response.curves.summary <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  min.rsquare.response <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  min.slope.response <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  max.slope.response <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  max.yintercept.response <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  max.dratio.sd.conc.bqc <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  max.dratio.sd.conc.tqc <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  max.dratio.mad.conc.bqc <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  max.dratio.mad.conc.tqc <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  max.dratio.sd.normint.bqc <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  max.dratio.sd.normint.tqc <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  max.dratio.mad.normint.bqc <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  max.dratio.mad.normint.tqc <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>MidarExperiment object.</p></dd>


<dt id="arg-replace-existing">replace_existing<a class="anchor" aria-label="anchor" href="#arg-replace-existing"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, replaces any existing filters; if <code>FALSE</code>, adds new filters on top of existing ones. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-batch-medians">batch_medians<a class="anchor" aria-label="anchor" href="#arg-batch-medians"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, uses batch-wise median QC values for filtering. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-qualifier-include">qualifier.include<a class="anchor" aria-label="anchor" href="#arg-qualifier-include"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, includes qualifier features in the filtering process. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-istd-include">istd.include<a class="anchor" aria-label="anchor" href="#arg-istd-include"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, includes internal standards (ISTDs) in the filtering process. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-features-to-keep">features.to.keep<a class="anchor" aria-label="anchor" href="#arg-features-to-keep"></a></dt>
<dd><p>A vector of feature identifiers to retain, even if they do not meet the filtering criteria.</p></dd>


<dt id="arg-max-prop-missing-intensity-spl">max.prop.missing.intensity.spl<a class="anchor" aria-label="anchor" href="#arg-max-prop-missing-intensity-spl"></a></dt>
<dd><p>Maximum proportion of missing intensity values among study samples (SPL). Default is <code>NA</code>.</p></dd>


<dt id="arg-max-prop-missing-normintensity-spl">max.prop.missing.normintensity.spl<a class="anchor" aria-label="anchor" href="#arg-max-prop-missing-normintensity-spl"></a></dt>
<dd><p>Maximum proportion of missing normalized intensity values among study samples (SPL). Default is <code>NA</code>.</p></dd>


<dt id="arg-max-prop-missing-conc-spl">max.prop.missing.conc.spl<a class="anchor" aria-label="anchor" href="#arg-max-prop-missing-conc-spl"></a></dt>
<dd><p>Maximum proportion of missing concentration values among study samples (SPL). Default is <code>NA</code>.</p></dd>


<dt id="arg-min-intensity-lowest-bqc">min.intensity.lowest.bqc<a class="anchor" aria-label="anchor" href="#arg-min-intensity-lowest-bqc"></a></dt>
<dd><p>Minimum intensity of the lowest BQC sample. Default is <code>NA</code>.</p></dd>


<dt id="arg-min-intensity-lowest-tqc">min.intensity.lowest.tqc<a class="anchor" aria-label="anchor" href="#arg-min-intensity-lowest-tqc"></a></dt>
<dd><p>Minimum intensity of the lowest TQC sample. Default is <code>NA</code>.</p></dd>


<dt id="arg-min-intensity-lowest-spl">min.intensity.lowest.spl<a class="anchor" aria-label="anchor" href="#arg-min-intensity-lowest-spl"></a></dt>
<dd><p>Minimum intensity of the lowest study sample (SPL). Default is <code>NA</code>.</p></dd>


<dt id="arg-min-intensity-median-bqc">min.intensity.median.bqc<a class="anchor" aria-label="anchor" href="#arg-min-intensity-median-bqc"></a></dt>
<dd><p>Minimum median intensity of BQC samples. Default is <code>NA</code>.</p></dd>


<dt id="arg-min-intensity-median-tqc">min.intensity.median.tqc<a class="anchor" aria-label="anchor" href="#arg-min-intensity-median-tqc"></a></dt>
<dd><p>Minimum median intensity of TQC samples. Default is <code>NA</code>.</p></dd>


<dt id="arg-min-intensity-median-spl">min.intensity.median.spl<a class="anchor" aria-label="anchor" href="#arg-min-intensity-median-spl"></a></dt>
<dd><p>Minimum median intensity of study samples (SPL). Default is <code>NA</code>.</p></dd>


<dt id="arg-min-intensity-highest-spl">min.intensity.highest.spl<a class="anchor" aria-label="anchor" href="#arg-min-intensity-highest-spl"></a></dt>
<dd><p>Minimum intensity of the highest intensity study sample (SPL). Default is <code>NA</code>.</p></dd>


<dt id="arg-min-signalblank-median-spl-pblk">min.signalblank.median.spl.pblk<a class="anchor" aria-label="anchor" href="#arg-min-signalblank-median-spl-pblk"></a></dt>
<dd><p>Minimum signal-to-blank ratio for SPL samples and PBLK. Default is <code>NA</code>.</p></dd>


<dt id="arg-min-signalblank-median-spl-ublk">min.signalblank.median.spl.ublk<a class="anchor" aria-label="anchor" href="#arg-min-signalblank-median-spl-ublk"></a></dt>
<dd><p>Minimum signal-to-blank ratio for SPL samples and UBLK. Default is <code>NA</code>.</p></dd>


<dt id="arg-min-signalblank-median-spl-sblk">min.signalblank.median.spl.sblk<a class="anchor" aria-label="anchor" href="#arg-min-signalblank-median-spl-sblk"></a></dt>
<dd><p>Minimum signal-to-blank ratio for SPL samples and SBLK. Default is <code>NA</code>.</p></dd>


<dt id="arg-max-cv-intensity-bqc">max.cv.intensity.bqc<a class="anchor" aria-label="anchor" href="#arg-max-cv-intensity-bqc"></a></dt>
<dd><p>Maximum CV for intensity in BQC samples. Default is <code>NA</code>.</p></dd>


<dt id="arg-max-cv-intensity-tqc">max.cv.intensity.tqc<a class="anchor" aria-label="anchor" href="#arg-max-cv-intensity-tqc"></a></dt>
<dd><p>Maximum CV for intensity in TQC samples. Default is <code>NA</code>.</p></dd>


<dt id="arg-max-cv-normintensity-bqc">max.cv.normintensity.bqc<a class="anchor" aria-label="anchor" href="#arg-max-cv-normintensity-bqc"></a></dt>
<dd><p>Maximum CV for normalized intensity in BQC samples. Default is <code>NA</code>.</p></dd>


<dt id="arg-max-cv-normintensity-tqc">max.cv.normintensity.tqc<a class="anchor" aria-label="anchor" href="#arg-max-cv-normintensity-tqc"></a></dt>
<dd><p>Maximum CV for normalized intensity in TQC samples. Default is <code>NA</code>.</p></dd>


<dt id="arg-max-cv-conc-bqc">max.cv.conc.bqc<a class="anchor" aria-label="anchor" href="#arg-max-cv-conc-bqc"></a></dt>
<dd><p>Maximum CV for concentration in BQC samples. Default is <code>NA</code>.</p></dd>


<dt id="arg-max-cv-conc-tqc">max.cv.conc.tqc<a class="anchor" aria-label="anchor" href="#arg-max-cv-conc-tqc"></a></dt>
<dd><p>Maximum CV for concentration in TQC samples. Default is <code>NA</code>.</p></dd>


<dt id="arg-response-curves-select">response.curves.select<a class="anchor" aria-label="anchor" href="#arg-response-curves-select"></a></dt>
<dd><p>Select specific response curves by ID. Default is <code>NA</code>.</p></dd>


<dt id="arg-response-curves-summary">response.curves.summary<a class="anchor" aria-label="anchor" href="#arg-response-curves-summary"></a></dt>
<dd><p>Define the method to summarize multiple response curves. Default is <code>NA</code>.</p></dd>


<dt id="arg-min-rsquare-response">min.rsquare.response<a class="anchor" aria-label="anchor" href="#arg-min-rsquare-response"></a></dt>
<dd><p>Minimum R-squared value for the response curves. Default is <code>NA</code>.</p></dd>


<dt id="arg-min-slope-response">min.slope.response<a class="anchor" aria-label="anchor" href="#arg-min-slope-response"></a></dt>
<dd><p>Minimum slope for the response curve. Default is <code>NA</code>.</p></dd>


<dt id="arg-max-slope-response">max.slope.response<a class="anchor" aria-label="anchor" href="#arg-max-slope-response"></a></dt>
<dd><p>Maximum slope for the response curve. Default is <code>NA</code>.</p></dd>


<dt id="arg-max-yintercept-response">max.yintercept.response<a class="anchor" aria-label="anchor" href="#arg-max-yintercept-response"></a></dt>
<dd><p>Maximum y-intercept of the response curve. Default is <code>NA</code>.</p></dd>


<dt id="arg-max-dratio-sd-conc-bqc">max.dratio.sd.conc.bqc<a class="anchor" aria-label="anchor" href="#arg-max-dratio-sd-conc-bqc"></a></dt>
<dd><p>Maximum allowed D-ratio (SD of BQC / SD of SPL) using standard deviation for BQC samples. Default is <code>NA</code>.</p></dd>


<dt id="arg-max-dratio-sd-conc-tqc">max.dratio.sd.conc.tqc<a class="anchor" aria-label="anchor" href="#arg-max-dratio-sd-conc-tqc"></a></dt>
<dd><p>Maximum allowed D-ratio (SD of TQC / SD of SPL) using standard deviation for TQC samples. Default is <code>NA</code>.</p></dd>


<dt id="arg-max-dratio-mad-conc-bqc">max.dratio.mad.conc.bqc<a class="anchor" aria-label="anchor" href="#arg-max-dratio-mad-conc-bqc"></a></dt>
<dd><p>Maximum allowed D-ratio (MAD of BQC / MAD of SPL) using mean absolute deviation for BQC samples. Default is <code>NA</code>.</p></dd>


<dt id="arg-max-dratio-mad-conc-tqc">max.dratio.mad.conc.tqc<a class="anchor" aria-label="anchor" href="#arg-max-dratio-mad-conc-tqc"></a></dt>
<dd><p>Maximum allowed D-ratio (MAD of TQC / MAD of SPL) using mean absolute deviation for TQC samples. Default is <code>NA</code>.</p></dd>


<dt id="arg-max-dratio-sd-normint-bqc">max.dratio.sd.normint.bqc<a class="anchor" aria-label="anchor" href="#arg-max-dratio-sd-normint-bqc"></a></dt>
<dd><p>Maximum allowed D-ratio (SD of normalized intensity in BQC / SD of SPL) using standard deviation. Default is <code>NA</code>.</p></dd>


<dt id="arg-max-dratio-sd-normint-tqc">max.dratio.sd.normint.tqc<a class="anchor" aria-label="anchor" href="#arg-max-dratio-sd-normint-tqc"></a></dt>
<dd><p>Maximum allowed D-ratio (SD of normalized intensity in TQC / SD of SPL) using standard deviation. Default is <code>NA</code>.</p></dd>


<dt id="arg-max-dratio-mad-normint-bqc">max.dratio.mad.normint.bqc<a class="anchor" aria-label="anchor" href="#arg-max-dratio-mad-normint-bqc"></a></dt>
<dd><p>Maximum allowed D-ratio (MAD of normalized intensity in BQC / MAD of SPL) using mean absolute deviation. Default is <code>NA</code>.</p></dd>


<dt id="arg-max-dratio-mad-normint-tqc">max.dratio.mad.normint.tqc<a class="anchor" aria-label="anchor" href="#arg-max-dratio-mad-normint-tqc"></a></dt>
<dd><p>Maximum allowed D-ratio (MAD of normalized intensity in TQC / MAD of SPL) using mean absolute deviation. Default is <code>NA</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The input MidarExperiment object with the feature filtering criteria applied.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function implements filtering criteria based on quality control (QC) samples
and additional analytical parameters, following recommendations outlined by
Broadhurst et al. (2018). The implemented criteria evaluate data quality through
analysis of QC samples, blanks, and study samples.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Broadhurst, D., Goodacre, R., Reinke, S. N., Kuligowski, J., Wilson, I. D.,
Lewis, M. R., &amp; Dunn, W. B. (2018). Guidelines and considerations for the use
of system suitability and quality control samples in mass spectrometry assays
applied in clinical studies. <em>Metabolomics</em>, 14(6), 72.
<a href="https://doi.org/10.1007/s11306-018-1367-3" class="external-link">doi:10.1007/s11306-018-1367-3</a></p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bo Burla.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

